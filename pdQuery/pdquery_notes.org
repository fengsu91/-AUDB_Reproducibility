#+TITLE: investigation of bad RADB query performance

* PDBench on debussy 1GB
** Q3
*** optimized with merging

    #+begin_src sql
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", F0."c_name" AS "ub_c_name", F0."c_name" AS "lb_c_name", F0."c_address" AS "ub_c_address", F0."c_address" AS "lb_c_address", F0."c_nationkey" AS "ub_c_nationkey", F0."c_nationkey" AS "lb_c_nationkey", F0."c_phone" AS "ub_c_phone", F0."c_phone" AS "lb_c_phone", F0."c_acctbal" AS "ub_c_acctbal", F0."c_acctbal" AS "lb_c_acctbal", F0."c_mktsegment" AS "ub_c_mktsegment", F0."c_mktsegment" AS "lb_c_mktsegment", F0."c_comment" AS "ub_c_comment", F0."c_comment" AS "lb_c_comment", (CASE  WHEN (((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_c_custkey" = F0."lb_c_custkey")) AND (F0."ub_c_name" = F0."lb_c_name")) AND (F0."ub_c_address" = F0."lb_c_address")) AND (F0."ub_c_nationkey" = F0."lb_c_nationkey")) AND (F0."ub_c_phone" = F0."lb_c_phone")) AND (F0."ub_c_acctbal" = F0."lb_c_acctbal")) AND (F0."ub_c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."ub_c_comment" = F0."lb_c_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "customer_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (((((((((F0."tid" = F0."lb_tid") AND (F0."c_custkey" = F0."lb_c_custkey")) AND (F0."c_name" = F0."lb_c_name")) AND (F0."c_address" = F0."lb_c_address")) AND (F0."c_nationkey" = F0."lb_c_nationkey")) AND (F0."c_phone" = F0."lb_c_phone")) AND (F0."c_acctbal" = F0."lb_c_acctbal")) AND (F0."c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."c_comment" = F0."lb_c_comment"))) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_regionkey" AS "ub_n_regionkey", F0."n_regionkey" AS "lb_n_regionkey", F0."n_comment" AS "ub_n_comment", F0."n_comment" AS "lb_n_comment", (CASE  WHEN (((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) AND (F0."ub_n_name" = F0."lb_n_name")) AND (F0."ub_n_regionkey" = F0."lb_n_regionkey")) AND (F0."ub_n_comment" = F0."lb_n_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'CHINA') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('CHINA' = 'CHINA'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (((((F0."tid" = F0."lb_tid") AND (F0."n_nationkey" = F0."lb_n_nationkey")) AND (F0."n_name" = F0."lb_n_name")) AND (F0."n_regionkey" = F0."lb_n_regionkey")) AND (F0."n_comment" = F0."lb_n_comment"))) F1 ON ((F0."c_nationkey" = F1."n_nationkey")))) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderstatus" AS "ub_o_orderstatus", F0."o_orderstatus" AS "lb_o_orderstatus", F0."o_totalprice" AS "ub_o_totalprice", F0."o_totalprice" AS "lb_o_totalprice", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_orderpriority" AS "ub_o_orderpriority", F0."o_orderpriority" AS "lb_o_orderpriority", F0."o_clerk" AS "ub_o_clerk", F0."o_clerk" AS "lb_o_clerk", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", F0."o_comment" AS "ub_o_comment", F0."o_comment" AS "lb_o_comment", (CASE  WHEN ((((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_custkey" = F0."lb_o_custkey")) AND (F0."ub_o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."ub_o_totalprice" = F0."lb_o_totalprice")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."ub_o_clerk" = F0."lb_o_clerk")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) AND (F0."ub_o_comment" = F0."lb_o_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((((((((((F0."tid" = F0."lb_tid") AND (F0."o_orderkey" = F0."lb_o_orderkey")) AND (F0."o_custkey" = F0."lb_o_custkey")) AND (F0."o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."o_totalprice" = F0."lb_o_totalprice")) AND (F0."o_orderdate" = F0."lb_o_orderdate")) AND (F0."o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."o_clerk" = F0."lb_o_clerk")) AND (F0."o_shippriority" = F0."lb_o_shippriority")) AND (F0."o_comment" = F0."lb_o_comment"))) F1 ON ((F0."c_custkey" = F1."o_custkey")))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."ub_n_name" = F0."lb_n_name") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."n_nationkey" = F0."lb_n_nationkey") AND (F0."n_name" = F0."lb_n_name"))) F0 JOIN (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."s_suppkey" AS "ub_s_suppkey", F0."s_suppkey" AS "lb_s_suppkey", F0."s_nationkey" AS "ub_s_nationkey", F0."s_nationkey" AS "lb_s_nationkey", (CASE  WHEN ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F0."ub_s_nationkey" = F0."lb_s_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "supplier_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."s_suppkey" = F0."lb_s_suppkey") AND (F0."s_nationkey" = F0."lb_s_nationkey"))) F1 ON ((F0."n_nationkey" = F1."s_nationkey")))) F0 JOIN (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", F0."l_suppkey" AS "ub_l_suppkey", F0."l_suppkey" AS "lb_l_suppkey", (CASE  WHEN ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F0."ub_l_suppkey" = F0."lb_l_suppkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."l_orderkey" = F0."lb_l_orderkey") AND (F0."l_suppkey" = F0."lb_l_suppkey"))) F1 ON ((F0."s_suppkey" = F1."l_suppkey")))) F0 JOIN (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", (CASE  WHEN (F0."ub_o_orderkey" = F0."lb_o_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (F0."o_orderkey" = F0."lb_o_orderkey")) F1 ON ((F0."l_orderkey" = F1."o_orderkey")))) F1 ON ((F0."o1" = F1."o2"))) UNION ALL
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o1" = F1."o2") AND ((F0."ub_o1" = F0."lb_o1") AND (F1."ub_o2" = F1."lb_o2"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o1" = F1."o2") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_nationkey" = F1."n_nationkey") AND ((F0."ub_c_nationkey" = F0."lb_c_nationkey") AND (F1."ub_n_nationkey" = F1."lb_n_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_nationkey" = F1."n_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."tid") AS "tid", min(F0."c_custkey") AS "c_custkey", min(F0."c_name") AS "c_name", min(F0."c_address") AS "c_address", (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "c_nationkey", min(F0."c_phone") AS "c_phone", min(F0."c_acctbal") AS "c_acctbal", min(F0."c_mktsegment") AS "c_mktsegment", min(F0."c_comment") AS "c_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", max(F0."ub_c_name") AS "ub_c_name", min(F0."lb_c_name") AS "lb_c_name", max(F0."ub_c_address") AS "ub_c_address", min(F0."lb_c_address") AS "lb_c_address", max(F0."ub_c_nationkey") AS "ub_c_nationkey", min(F0."lb_c_nationkey") AS "lb_c_nationkey", max(F0."ub_c_phone") AS "ub_c_phone", min(F0."lb_c_phone") AS "lb_c_phone", max(F0."ub_c_acctbal") AS "ub_c_acctbal", min(F0."lb_c_acctbal") AS "lb_c_acctbal", max(F0."ub_c_mktsegment") AS "ub_c_mktsegment", min(F0."lb_c_mktsegment") AS "lb_c_mktsegment", max(F0."ub_c_comment") AS "ub_c_comment", min(F0."lb_c_comment") AS "lb_c_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "customer_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."tid") AS "tid", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", min(F0."n_name") AS "n_name", min(F0."n_regionkey") AS "n_regionkey", min(F0."n_comment") AS "n_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_regionkey") AS "ub_n_regionkey", min(F0."lb_n_regionkey") AS "lb_n_regionkey", max(F0."ub_n_comment") AS "ub_n_comment", min(F0."lb_n_comment") AS "lb_n_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_c_nationkey" <= F1."ub_n_nationkey") AND (F0."ub_c_nationkey" >= F1."lb_n_nationkey"))))) F0 JOIN (
      SELECT min(F0."tid") AS "tid", min(F0."o_orderkey") AS "o_orderkey", (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderstatus") AS "o_orderstatus", min(F0."o_totalprice") AS "o_totalprice", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_orderpriority") AS "o_orderpriority", min(F0."o_clerk") AS "o_clerk", min(F0."o_shippriority") AS "o_shippriority", min(F0."o_comment") AS "o_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderstatus") AS "ub_o_orderstatus", min(F0."lb_o_orderstatus") AS "lb_o_orderstatus", max(F0."ub_o_totalprice") AS "ub_o_totalprice", min(F0."lb_o_totalprice") AS "lb_o_totalprice", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_orderpriority") AS "ub_o_orderpriority", min(F0."lb_o_orderpriority") AS "lb_o_orderpriority", max(F0."ub_o_clerk") AS "ub_o_clerk", min(F0."lb_o_clerk") AS "lb_o_clerk", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", max(F0."ub_o_comment") AS "ub_o_comment", min(F0."lb_o_comment") AS "lb_o_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."l_orderkey" = F1."o_orderkey") AND ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F1."ub_o_orderkey" = F1."lb_o_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."l_orderkey" = F1."o_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."s_suppkey" = F1."l_suppkey") AND ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F1."ub_l_suppkey" = F1."lb_l_suppkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."s_suppkey" = F1."l_suppkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."n_nationkey" = F1."s_nationkey") AND ((F0."ub_n_nationkey" = F0."lb_n_nationkey") AND (F1."ub_s_nationkey" = F1."lb_s_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."n_nationkey" = F1."s_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."n_name") AS "n_name", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."s_suppkey") AS "s_suppkey", (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "s_nationkey", max(F0."ub_s_suppkey") AS "ub_s_suppkey", min(F0."lb_s_suppkey") AS "lb_s_suppkey", max(F0."ub_s_nationkey") AS "ub_s_nationkey", min(F0."lb_s_nationkey") AS "lb_s_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "supplier_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_n_nationkey" <= F1."ub_s_nationkey") AND (F0."ub_n_nationkey" >= F1."lb_s_nationkey"))))) F0 JOIN (
      SELECT min(F0."l_orderkey") AS "l_orderkey", (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END) AS "l_suppkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", max(F0."ub_l_suppkey") AS "ub_l_suppkey", min(F0."lb_l_suppkey") AS "lb_l_suppkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_s_suppkey" <= F1."ub_l_suppkey") AND (F0."ub_s_suppkey" >= F1."lb_l_suppkey"))))) F0 JOIN (
      SELECT (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "o_orderkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_l_orderkey" <= F1."ub_o_orderkey") AND (F0."ub_l_orderkey" >= F1."lb_o_orderkey"))))) F1 ON (((F0."lb_o1" <= F1."ub_o2") AND (F0."ub_o1" >= F1."lb_o2"))));
    #+end_src
- postgres plan (not executed)
#+begin_example
                                                                                                                                                                                             QUERY PLAN

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  -------------------------------------------------------------------------------------------------------------------
   Append  (cost=3000.00..499787941331833.81 rows=1568403959453313 width=216)
     ->  Subquery Scan on "*SELECT* 1"  (cost=3000.00..570822.71 rows=1 width=216)
           ->  Nested Loop  (cost=3000.00..570822.69 rows=1 width=204)
                 Join Filter: (f0_2.o_orderkey = f0_6.o_orderkey)
                 ->  Nested Loop  (cost=2000.00..488497.92 rows=1 width=905)
                       Join Filter: (f0_4.s_nationkey = f0_3.n_nationkey)
                       ->  Nested Loop  (cost=2000.00..488480.41 rows=1 width=805)
                             Join Filter: (f0_5.l_suppkey = f0_4.s_suppkey)
                             ->  Nested Loop  (cost=2000.00..487693.39 rows=1 width=781)
                                   Join Filter: (f0.c_nationkey = f0_1.n_nationkey)
                                   ->  Nested Loop  (cost=2000.00..487673.63 rows=1 width=601)
                                         Join Filter: (f0_2.o_custkey = f0.c_custkey)
                                         ->  Seq Scan on customer_2_100_radb f0  (cost=0.00..15599.00 rows=1 width=343)
                                               Filter: ((bst_r > 0) AND (tid = tid) AND (c_custkey = c_custkey) AND (c_name = c_name) AND (c_address = c_address) AND (c_nationkey = c_nationkey) AND (c_phone = c_phone) AND (c_acctbal = c_acctbal) AND (c_mktsegment = c_mkts
  egment) AND (c_comment = c_comment))
                                         ->  Nested Loop  (cost=2000.00..472074.62 rows=1 width=266)
                                               Join Filter: (f0_2.o_orderkey = f0_5.l_orderkey)
                                               ->  Gather  (cost=1000.00..95543.30 rows=1 width=234)
                                                     Workers Planned: 2
                                                     ->  Parallel Seq Scan on orders_2_100_radb f0_2  (cost=0.00..94543.20 rows=1 width=234)
                                                           Filter: ((bst_r > 0) AND (tid = tid) AND (o_orderkey = o_orderkey) AND (o_custkey = o_custkey) AND (o_orderstatus = o_orderstatus) AND (o_totalprice = o_totalprice) AND (o_orderdate = o_orderdate) AND (o_orderprio
  rity = o_orderpriority) AND (o_clerk = o_clerk) AND (o_shippriority = o_shippriority) AND (o_comment = o_comment))
                                               ->  Gather  (cost=1000.00..376529.44 rows=150 width=32)
                                                     Workers Planned: 2
                                                     ->  Parallel Seq Scan on lineitem_2_100_radb f0_5  (cost=0.00..375514.44 rows=62 width=32)
                                                           Filter: ((bst_r > 0) AND (l_orderkey = l_orderkey) AND (l_suppkey = l_suppkey))
                                   ->  Seq Scan on nation_2_100_radb f0_1  (cost=0.00..19.75 rows=1 width=188)
                                         Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text) AND (tid = tid) AND (n_nationkey = n_nationkey) AND (n_name = n_name) AND (n_regionkey = n_regionkey) AND (n_comment = n_comment) AND (CASE WHEN (n_name = 'CHIN
  A'::text) THEN 1 ELSE 0 END > 0))
                             ->  Seq Scan on supplier_2_100_radb f0_4  (cost=0.00..787.00 rows=1 width=32)
                                   Filter: ((bst_r > 0) AND (s_suppkey = s_suppkey) AND (s_nationkey = s_nationkey))
                       ->  Seq Scan on nation_2_100_radb f0_3  (cost=0.00..17.50 rows=1 width=108)
                             Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text) AND (n_nationkey = n_nationkey) AND (n_name = n_name) AND (CASE WHEN (n_name = 'GERMANY'::text) THEN 1 ELSE 0 END > 0))
                 ->  Gather  (cost=1000.00..82230.88 rows=7500 width=20)
                       Workers Planned: 2
                       ->  Parallel Seq Scan on orders_2_100_radb f0_6  (cost=0.00..80480.88 rows=3125 width=20)
                             Filter: ((bst_r > 0) AND (o_orderkey = o_orderkey))
     ->  Nested Loop  (cost=879893.71..484103901166478.00 rows=1568403959453312 width=216)
           Join Filter: ((f1_2.lb_s_suppkey <= f1_1.ub_l_suppkey) AND (f1_2.ub_s_suppkey >= f1_1.lb_l_suppkey))
           ->  Nested Loop  (cost=878866.14..25036963495823.12 rows=158800900894648 width=312)
                 Join Filter: ((f1_1.lb_l_orderkey <= f1.ub_o_orderkey) AND (f1_1.ub_l_orderkey >= f1.lb_o_orderkey))
                 ->  Nested Loop  (cost=448745.47..25821173996.00 rows=143020925453 width=264)
                       Join Filter: ((f0_7.lb_c_custkey <= (max(f0_8.ub_o_custkey))) AND (f0_7.ub_c_custkey >= (min(f0_8.lb_o_custkey))))
                       ->  Nested Loop  (cost=435030.30..3295376057.40 rows=14462782797 width=84)
                             Join Filter: (((min(f0_8.lb_o_orderkey)) <= f1.ub_o_orderkey) AND ((max(f0_8.ub_o_orderkey)) >= f1.lb_o_orderkey))
                             ->  Finalize GroupAggregate  (cost=158165.23..199469.48 rows=87637 width=660)
                                   Group Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                   ->  Gather Merge  (cost=158165.23..193992.17 rows=175274 width=40)
                                         Workers Planned: 2
                                         ->  Partial GroupAggregate  (cost=157165.21..172761.18 rows=87637 width=40)
                                               Group Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                               ->  Sort  (cost=157165.21..158727.69 rows=624992 width=28)
                                                     Sort Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                                     ->  Parallel Seq Scan on orders_2_100_radb f0_8  (cost=0.00..82043.36 rows=624992 width=28)
                             ->  Materialize  (cost=276865.06..362990.17 rows=1485275 width=36)
                                   ->  Subquery Scan on f1  (cost=276865.06..343959.79 rows=1485275 width=36)
                                         ->  GroupAggregate  (cost=276865.06..329107.04 rows=1485275 width=36)
                                               Group Key: (CASE WHEN (f0_9.o_orderkey >= 300000) THEN 300000 WHEN ((f0_9.o_orderkey < 300000) AND (f0_9.o_orderkey >= 1)) THEN 1 ELSE 1 END)
                                               ->  Sort  (cost=276865.06..280615.02 rows=1499981 width=16)
                                                     Sort Key: (CASE WHEN (f0_9.o_orderkey >= 300000) THEN 300000 WHEN ((f0_9.o_orderkey < 300000) AND (f0_9.o_orderkey >= 1)) THEN 1 ELSE 1 END)
                                                     ->  Seq Scan on orders_2_100_radb f0_9  (cost=0.00..97355.67 rows=1499981 width=16)
                       ->  Materialize  (cost=13715.17..13732.50 rows=89 width=180)
                             ->  Nested Loop  (cost=13715.17..13732.05 rows=89 width=180)
                                   Join Filter: ((f0_7.lb_c_nationkey <= (max(f0_10.ub_n_nationkey))) AND (f0_7.ub_c_nationkey >= (min(f0_10.lb_n_nationkey))))
                                   ->  HashAggregate  (cost=15.57..16.13 rows=32 width=252)
                                         Group Key: CASE WHEN (f0_10.n_nationkey >= 12) THEN 12 WHEN ((f0_10.n_nationkey < 12) AND (f0_10.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                         ->  Seq Scan on nation_2_100_radb f0_10  (cost=0.00..14.75 rows=33 width=108)
                                               Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text))
                                   ->  Materialize  (cost=13699.60..13701.66 rows=25 width=48)
                                         ->  Subquery Scan on f0_7  (cost=13699.60..13701.54 rows=25 width=48)
                                               ->  Finalize GroupAggregate  (cost=13699.60..13701.29 rows=25 width=564)
                                                     Group Key: (CASE WHEN (f0_11.c_nationkey >= 12) THEN 12 WHEN ((f0_11.c_nationkey < 12) AND (f0_11.c_nationkey >= 0)) THEN 0 ELSE 0 END)
                                                     ->  Sort  (cost=13699.60..13699.72 rows=50 width=40)
                                                           Sort Key: (CASE WHEN (f0_11.c_nationkey >= 12) THEN 12 WHEN ((f0_11.c_nationkey < 12) AND (f0_11.c_nationkey >= 0)) THEN 0 ELSE 0 END)
                                                           ->  Gather  (cost=13692.75..13698.19 rows=50 width=40)
                                                                 Workers Planned: 2
                                                                 ->  Partial HashAggregate  (cost=12692.75..12693.19 rows=25 width=40)
                                                                       Group Key: CASE WHEN (f0_11.c_nationkey >= 12) THEN 12 WHEN ((f0_11.c_nationkey < 12) AND (f0_11.c_nationkey >= 0)) THEN 0 ELSE 0 END
                                                                       ->  Parallel Seq Scan on customer_2_100_radb f0_11  (cost=0.00..11442.75 rows=62500 width=28)
                 ->  Materialize  (cost=430120.67..430945.09 rows=9993 width=48)
                       ->  Subquery Scan on f1_1  (cost=430120.67..430895.13 rows=9993 width=48)
                             ->  Finalize GroupAggregate  (cost=430120.67..430795.20 rows=9993 width=48)
                                   Group Key: (CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                   ->  Sort  (cost=430120.67..430170.64 rows=19986 width=40)
                                         Sort Key: (CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                         ->  Gather  (cost=426519.52..428693.00 rows=19986 width=40)
                                               Workers Planned: 2
                                               ->  Partial HashAggregate  (cost=425519.52..425694.40 rows=9993 width=40)
                                                     Group Key: CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END
                                                     ->  Parallel Seq Scan on lineitem_2_100_radb f0_12  (cost=0.00..375514.44 rows=2500254 width=28)
           ->  Materialize  (cost=1027.57..1043.65 rows=89 width=180)
                 ->  Nested Loop  (cost=1027.57..1043.20 rows=89 width=180)
                       Join Filter: (((min(f0_13.lb_n_nationkey)) <= f1_2.ub_s_nationkey) AND ((max(f0_13.ub_n_nationkey)) >= f1_2.lb_s_nationkey))
                       ->  HashAggregate  (cost=15.57..16.13 rows=32 width=132)
                             Group Key: CASE WHEN (f0_13.n_nationkey >= 12) THEN 12 WHEN ((f0_13.n_nationkey < 12) AND (f0_13.n_nationkey >= 0)) THEN 0 ELSE 0 END
                             ->  Seq Scan on nation_2_100_radb f0_13  (cost=0.00..14.75 rows=33 width=108)
                                   Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text))
                       ->  Materialize  (cost=1012.00..1012.81 rows=25 width=48)
                             ->  Subquery Scan on f1_2  (cost=1012.00..1012.69 rows=25 width=48)
                                   ->  HashAggregate  (cost=1012.00..1012.44 rows=25 width=48)
                                         Group Key: CASE WHEN (f0_14.s_nationkey >= 12) THEN 12 WHEN ((f0_14.s_nationkey < 12) AND (f0_14.s_nationkey >= 0)) THEN 0 ELSE 0 END
                                         ->  Seq Scan on supplier_2_100_radb f0_14  (cost=0.00..787.00 rows=10000 width=28)
#+end_example
- plan with execution
#+begin_example

#+end_example
**** potential source of the problem
- looks like there are nested lops in the non-possible parts
  - this is caused by postgres underestimating the result sizes of the joins based on redundant conditions infered by GProM's optimizer
  - for instance: =F0."l_suppkey" = F0."lb_l_suppkey"=
#+begin_example
         ->  Nested Loop  (cost=3000.00..570822.69 rows=1 width=204)
               Join Filter: (f0_2.o_orderkey = f0_6.o_orderkey)
               ->  Nested Loop  (cost=2000.00..488497.92 rows=1 width=905)
                     Join Filter: (f0_4.s_nationkey = f0_3.n_nationkey)
                     ->  Nested Loop  (cost=2000.00..488480.41 rows=1 width=805)
                           Join Filter: (f0_5.l_suppkey = f0_4.s_suppkey)
                           ->  Nested Loop  (cost=2000.00..487693.39 rows=1 width=781)
                                 Join Filter: (f0.c_nationkey = f0_1.n_nationkey)
                                 ->  Nested Loop  (cost=2000.00..487673.63 rows=1 width=601)
                                       Join Filter: (f0_2.o_custkey = f0.c_custkey)
                                       ->  Seq Scan on customer_2_100_radb f0  (cost=0.00..15599.00 rows=1 width=343)
                                             Filter: ((bst_r > 0) AND (tid = tid) AND (c_custkey = c_custkey) AND (c_name = c_name) AND (c_address = c_address) AND (c_nationkey = c_nationkey) AND (c_phone = c_phone) AND (c_acctbal = c_acctbal) AND (c_mktsegment = c_mktsegment) AND (c_comment = c_comment))
                                       ->  Nested Loop  (cost=2000.00..472074.62 rows=1 width=266)
                                             Join Filter: (f0_2.o_orderkey = f0_5.l_orderkey)
                                             ->  Gather  (cost=1000.00..95543.30 rows=1 width=234)
                                                   Workers Planned: 2
                                                   ->  Parallel Seq Scan on orders_2_100_radb f0_2  (cost=0.00..94543.20 rows=1 width=234)
                                                         Filter: ((bst_r > 0) AND (tid = tid) AND (o_orderkey = o_orderkey) AND (o_custkey = o_custkey) AND (o_orderstatus = o_orderstatus) AND (o_totalprice = o_totalprice) AND (o_orderdate = o_orderdate) AND (o_orderpriority = o_orderpriority) AND (o_clerk = o_clerk) AND (o_shippriority = o_shippriority) AND (o_comment = o_comment))
                                             ->  Gather  (cost=1000.00..376529.44 rows=150 width=32)
                                                   Workers Planned: 2
                                                   ->  Parallel Seq Scan on lineitem_2_100_radb f0_5  (cost=0.00..375514.44 rows=62 width=32)
                                                         Filter: ((bst_r > 0) AND (l_orderkey = l_orderkey) AND (l_suppkey = l_suppkey))
                                 ->  Seq Scan on nation_2_100_radb f0_1  (cost=0.00..19.75 rows=1 width=188)
                                       Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text) AND (tid = tid) AND (n_nationkey = n_nationkey) AND (n_name = n_name) AND (n_regionkey = n_regionkey) AND (n_comment = n_comment) AND (CASE WHEN (n_name = 'CHINA'::text) THEN 1 ELSE 0 END > 0))
                           ->  Seq Scan on supplier_2_100_radb f0_4  (cost=0.00..787.00 rows=1 width=32)
                                 Filter: ((bst_r > 0) AND (s_suppkey = s_suppkey) AND (s_nationkey = s_nationkey))
                     ->  Seq Scan on nation_2_100_radb f0_3  (cost=0.00..17.50 rows=1 width=108)
                           Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text) AND (n_nationkey = n_nationkey) AND (n_name = n_name) AND (CASE WHEN (n_name = 'GERMANY'::text) THEN 1 ELSE 0 END > 0))
#+end_example
*** optimized with merging but no selection move-around
    #+begin_src sql
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", F0."c_name" AS "ub_c_name", F0."c_name" AS "lb_c_name", F0."c_address" AS "ub_c_address", F0."c_address" AS "lb_c_address", F0."c_nationkey" AS "ub_c_nationkey", F0."c_nationkey" AS "lb_c_nationkey", F0."c_phone" AS "ub_c_phone", F0."c_phone" AS "lb_c_phone", F0."c_acctbal" AS "ub_c_acctbal", F0."c_acctbal" AS "lb_c_acctbal", F0."c_mktsegment" AS "ub_c_mktsegment", F0."c_mktsegment" AS "lb_c_mktsegment", F0."c_comment" AS "ub_c_comment", F0."c_comment" AS "lb_c_comment", (CASE  WHEN (((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_c_custkey" = F0."lb_c_custkey")) AND (F0."ub_c_name" = F0."lb_c_name")) AND (F0."ub_c_address" = F0."lb_c_address")) AND (F0."ub_c_nationkey" = F0."lb_c_nationkey")) AND (F0."ub_c_phone" = F0."lb_c_phone")) AND (F0."ub_c_acctbal" = F0."lb_c_acctbal")) AND (F0."ub_c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."ub_c_comment" = F0."lb_c_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "customer_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_regionkey" AS "ub_n_regionkey", F0."n_regionkey" AS "lb_n_regionkey", F0."n_comment" AS "ub_n_comment", F0."n_comment" AS "lb_n_comment", (CASE  WHEN (((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) AND (F0."ub_n_name" = F0."lb_n_name")) AND (F0."ub_n_regionkey" = F0."lb_n_regionkey")) AND (F0."ub_n_comment" = F0."lb_n_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'CHINA') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('CHINA' = 'CHINA'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))) F0
      WHERE (F0."bst_r" > 0)) F1 ON ((F0."c_nationkey" = F1."n_nationkey")))) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderstatus" AS "ub_o_orderstatus", F0."o_orderstatus" AS "lb_o_orderstatus", F0."o_totalprice" AS "ub_o_totalprice", F0."o_totalprice" AS "lb_o_totalprice", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_orderpriority" AS "ub_o_orderpriority", F0."o_orderpriority" AS "lb_o_orderpriority", F0."o_clerk" AS "ub_o_clerk", F0."o_clerk" AS "lb_o_clerk", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", F0."o_comment" AS "ub_o_comment", F0."o_comment" AS "lb_o_comment", (CASE  WHEN ((((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_custkey" = F0."lb_o_custkey")) AND (F0."ub_o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."ub_o_totalprice" = F0."lb_o_totalprice")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."ub_o_clerk" = F0."lb_o_clerk")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) AND (F0."ub_o_comment" = F0."lb_o_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F1 ON ((F0."c_custkey" = F1."o_custkey")))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."ub_n_name" = F0."lb_n_name") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))) F0
      WHERE (F0."bst_r" > 0)) F0 JOIN (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."s_suppkey" AS "ub_s_suppkey", F0."s_suppkey" AS "lb_s_suppkey", F0."s_nationkey" AS "ub_s_nationkey", F0."s_nationkey" AS "lb_s_nationkey", (CASE  WHEN ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F0."ub_s_nationkey" = F0."lb_s_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "supplier_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F1 ON ((F0."n_nationkey" = F1."s_nationkey")))) F0 JOIN (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", F0."l_suppkey" AS "ub_l_suppkey", F0."l_suppkey" AS "lb_l_suppkey", (CASE  WHEN ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F0."ub_l_suppkey" = F0."lb_l_suppkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F1 ON ((F0."s_suppkey" = F1."l_suppkey")))) F0 JOIN (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", (CASE  WHEN (F0."ub_o_orderkey" = F0."lb_o_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F1 ON ((F0."l_orderkey" = F1."o_orderkey")))) F1 ON ((F0."o1" = F1."o2"))) UNION ALL
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o1" = F1."o2") AND ((F0."ub_o1" = F0."lb_o1") AND (F1."ub_o2" = F1."lb_o2"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o1" = F1."o2") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_nationkey" = F1."n_nationkey") AND ((F0."ub_c_nationkey" = F0."lb_c_nationkey") AND (F1."ub_n_nationkey" = F1."lb_n_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_nationkey" = F1."n_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."tid") AS "tid", min(F0."c_custkey") AS "c_custkey", min(F0."c_name") AS "c_name", min(F0."c_address") AS "c_address", (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "c_nationkey", min(F0."c_phone") AS "c_phone", min(F0."c_acctbal") AS "c_acctbal", min(F0."c_mktsegment") AS "c_mktsegment", min(F0."c_comment") AS "c_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", max(F0."ub_c_name") AS "ub_c_name", min(F0."lb_c_name") AS "lb_c_name", max(F0."ub_c_address") AS "ub_c_address", min(F0."lb_c_address") AS "lb_c_address", max(F0."ub_c_nationkey") AS "ub_c_nationkey", min(F0."lb_c_nationkey") AS "lb_c_nationkey", max(F0."ub_c_phone") AS "ub_c_phone", min(F0."lb_c_phone") AS "lb_c_phone", max(F0."ub_c_acctbal") AS "ub_c_acctbal", min(F0."lb_c_acctbal") AS "lb_c_acctbal", max(F0."ub_c_mktsegment") AS "ub_c_mktsegment", min(F0."lb_c_mktsegment") AS "lb_c_mktsegment", max(F0."ub_c_comment") AS "ub_c_comment", min(F0."lb_c_comment") AS "lb_c_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "customer_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."tid") AS "tid", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", min(F0."n_name") AS "n_name", min(F0."n_regionkey") AS "n_regionkey", min(F0."n_comment") AS "n_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_regionkey") AS "ub_n_regionkey", min(F0."lb_n_regionkey") AS "lb_n_regionkey", max(F0."ub_n_comment") AS "ub_n_comment", min(F0."lb_n_comment") AS "lb_n_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_c_nationkey" <= F1."ub_n_nationkey") AND (F0."ub_c_nationkey" >= F1."lb_n_nationkey"))))) F0 JOIN (
      SELECT min(F0."tid") AS "tid", min(F0."o_orderkey") AS "o_orderkey", (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderstatus") AS "o_orderstatus", min(F0."o_totalprice") AS "o_totalprice", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_orderpriority") AS "o_orderpriority", min(F0."o_clerk") AS "o_clerk", min(F0."o_shippriority") AS "o_shippriority", min(F0."o_comment") AS "o_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderstatus") AS "ub_o_orderstatus", min(F0."lb_o_orderstatus") AS "lb_o_orderstatus", max(F0."ub_o_totalprice") AS "ub_o_totalprice", min(F0."lb_o_totalprice") AS "lb_o_totalprice", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_orderpriority") AS "ub_o_orderpriority", min(F0."lb_o_orderpriority") AS "lb_o_orderpriority", max(F0."ub_o_clerk") AS "ub_o_clerk", min(F0."lb_o_clerk") AS "lb_o_clerk", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", max(F0."ub_o_comment") AS "ub_o_comment", min(F0."lb_o_comment") AS "lb_o_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."l_orderkey" = F1."o_orderkey") AND ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F1."ub_o_orderkey" = F1."lb_o_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."l_orderkey" = F1."o_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."s_suppkey" = F1."l_suppkey") AND ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F1."ub_l_suppkey" = F1."lb_l_suppkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."s_suppkey" = F1."l_suppkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."n_nationkey" = F1."s_nationkey") AND ((F0."ub_n_nationkey" = F0."lb_n_nationkey") AND (F1."ub_s_nationkey" = F1."lb_s_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."n_nationkey" = F1."s_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."n_name") AS "n_name", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."s_suppkey") AS "s_suppkey", (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "s_nationkey", max(F0."ub_s_suppkey") AS "ub_s_suppkey", min(F0."lb_s_suppkey") AS "lb_s_suppkey", max(F0."ub_s_nationkey") AS "ub_s_nationkey", min(F0."lb_s_nationkey") AS "lb_s_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "supplier_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_n_nationkey" <= F1."ub_s_nationkey") AND (F0."ub_n_nationkey" >= F1."lb_s_nationkey"))))) F0 JOIN (
      SELECT min(F0."l_orderkey") AS "l_orderkey", (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END) AS "l_suppkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", max(F0."ub_l_suppkey") AS "ub_l_suppkey", min(F0."lb_l_suppkey") AS "lb_l_suppkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_s_suppkey" <= F1."ub_l_suppkey") AND (F0."ub_s_suppkey" >= F1."lb_l_suppkey"))))) F0 JOIN (
      SELECT (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "o_orderkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_l_orderkey" <= F1."ub_o_orderkey") AND (F0."ub_l_orderkey" >= F1."lb_o_orderkey"))))) F1 ON (((F0."lb_o1" <= F1."ub_o2") AND (F0."ub_o1" >= F1."lb_o2"))));
    #+end_src
- postgres plan
#+begin_example
                                                                                                 QUERY PLAN
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Append  (cost=509492.34..10529389917221.50 rows=26942428382898 width=216) (actual time=4149.504..12057.504 rows=9048 loops=1)
   ->  Subquery Scan on "*SELECT* 1"  (cost=509492.34..630041.12 rows=20300 width=72) (actual time=4149.503..5811.852 rows=9032 loops=1)
         ->  Hash Join  (cost=509492.34..629685.87 rows=20300 width=60) (actual time=4149.501..5809.093 rows=9032 loops=1)
               Hash Cond: (f0_6.o_orderkey = f0_5.l_orderkey)
               ->  Seq Scan on orders_2_100_radb f0_6  (cost=0.00..89857.27 rows=1500102 width=20) (actual time=0.018..1071.983 rows=1500000 loops=1)
                     Filter: (bst_r > 0)
               ->  Hash  (cost=507081.07..507081.07 rows=20101 width=850) (actual time=4146.481..4146.481 rows=8936 loops=1)
                     Buckets: 8192  Batches: 8  Memory Usage: 1044kB
                     ->  Gather  (cost=117616.53..507081.07 rows=20101 width=850) (actual time=1774.838..4121.340 rows=8936 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=116616.53..504070.97 rows=8375 width=850) (actual time=1871.864..4101.207 rows=2979 loops=3)
                                 Hash Cond: (f0_5.l_orderkey = f0_2.o_orderkey)
                                 ->  Hash Join  (cost=795.02..375182.98 rows=199965 width=84) (actual time=9.021..2119.068 rows=77025 loops=3)
                                       Hash Cond: (f0_5.l_suppkey = f0_4.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem_2_100_radb f0_5  (cost=0.00..363012.54 rows=2500203 width=32) (actual time=0.014..1787.249 rows=2000405 loops=3)
                                             Filter: (bst_r > 0)
                                       ->  Hash  (cost=785.02..785.02 rows=800 width=60) (actual time=8.809..8.809 rows=384 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                             ->  Hash Join  (cost=2.52..785.02 rows=800 width=60) (actual time=0.099..8.616 rows=384 loops=3)
                                                   Hash Cond: (f0_4.s_nationkey = f0_3.n_nationkey)
                                                   ->  Seq Scan on supplier_2_100_radb f0_4  (cost=0.00..737.00 rows=10000 width=32) (actual time=0.021..7.134 rows=10000 loops=3)
                                                         Filter: (bst_r > 0)
                                                   ->  Hash  (cost=2.50..2.50 rows=2 width=36) (actual time=0.041..0.041 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on nation_2_100_radb f0_3  (cost=0.00..2.50 rows=2 width=36) (actual time=0.028..0.035 rows=1 loops=3)
                                                               Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text) AND (CASE WHEN (n_name = 'GERMANY'::text) THEN 1 ELSE 0 END > 0))
                                                               Rows Removed by Filter: 24
                                 ->  Hash  (cost=109028.82..109028.82 rows=62215 width=766) (actual time=1850.172..1850.172 rows=60677 loops=3)
                                       Buckets: 8192  Batches: 16  Memory Usage: 3199kB
                                       ->  Hash Join  (cost=12924.01..109028.82 rows=62215 width=766) (actual time=209.765..1686.657 rows=60677 loops=3)
                                             Hash Cond: (f0_2.o_custkey = f0.c_custkey)
                                             ->  Seq Scan on orders_2_100_radb f0_2  (cost=0.00..89857.27 rows=1500102 width=234) (actual time=0.031..1145.523 rows=1500000 loops=3)
                                                   Filter: (bst_r > 0)
                                             ->  Hash  (cost=12849.01..12849.01 rows=6000 width=540) (actual time=209.664..209.664 rows=6055 loops=3)
                                                   Buckets: 8192  Batches: 1  Memory Usage: 3640kB
                                                   ->  Hash Join  (cost=2.51..12849.01 rows=6000 width=540) (actual time=0.094..200.280 rows=6055 loops=3)
                                                         Hash Cond: (f0.c_nationkey = f0_1.n_nationkey)
                                                         ->  Seq Scan on customer_2_100_radb f0  (cost=0.00..12224.00 rows=150000 width=344) (actual time=0.015..174.175 rows=150000 loops=3)
                                                               Filter: (bst_r > 0)
                                                         ->  Hash  (cost=2.50..2.50 rows=1 width=204) (actual time=0.021..0.022 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on nation_2_100_radb f0_1  (cost=0.00..2.50 rows=1 width=204) (actual time=0.014..0.017 rows=1 loops=3)
                                                                     Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text) AND (CASE WHEN (n_name = 'CHINA'::text) THEN 1 ELSE 0 END > 0))
                                                                     Rows Removed by Filter: 24
   ->  Nested Loop  (cost=879891.66..10259965003554.40 rows=26942428362598 width=216) (actual time=5601.901..6244.295 rows=16 loops=1)
         Join Filter: (((min(f0_13.lb_s_suppkey)) <= f1_2.ub_l_suppkey) AND ((max(f0_13.ub_s_suppkey)) >= f1_2.lb_l_suppkey))
         ->  Nested Loop  (cost=878877.09..2294436057134.17 rows=14548911315803 width=312) (actual time=5588.895..6231.238 rows=8 loops=1)
               Join Filter: ((f1_2.lb_l_orderkey <= f1_1.ub_o_orderkey) AND (f1_2.ub_l_orderkey >= f1_1.lb_o_orderkey))
               ->  Nested Loop  (cost=448753.83..2982093971.48 rows=13087476446 width=264) (actual time=2591.963..3234.286 rows=4 loops=1)
                     Join Filter: (((min(f0_8.lb_o_orderkey)) <= f1_1.ub_o_orderkey) AND ((max(f0_8.ub_o_orderkey)) >= f1_1.lb_o_orderkey))
                     ->  Nested Loop  (cost=171873.36..227052.10 rows=79297 width=228) (actual time=1003.609..1003.625 rows=2 loops=1)
                           Join Filter: (((min(f0_9.lb_c_custkey)) <= (max(f0_8.ub_o_custkey))) AND ((max(f0_9.ub_c_custkey)) >= (min(f0_8.lb_o_custkey))))
                           ->  Finalize GroupAggregate  (cost=158171.29..199965.32 rows=89209 width=660) (actual time=922.134..922.145 rows=2 loops=1)
                                 Group Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                 ->  Gather Merge  (cost=158171.29..194389.75 rows=178418 width=40) (actual time=647.836..922.183 rows=6 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Partial GroupAggregate  (cost=157171.26..172795.87 rows=89209 width=40) (actual time=628.527..896.033 rows=2 loops=3)
                                             Group Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                             ->  Sort  (cost=157171.26..158733.87 rows=625042 width=28) (actual time=614.741..704.229 rows=500000 loops=3)
                                                   Sort Key: (CASE WHEN (f0_8.o_custkey >= 7500) THEN 7500 WHEN ((f0_8.o_custkey < 7500) AND (f0_8.o_custkey >= 1)) THEN 1 ELSE 1 END)
                                                   Sort Method: external merge  Disk: 19096kB
                                                   ->  Parallel Seq Scan on orders_2_100_radb f0_8  (cost=0.00..82044.24 rows=625042 width=28) (actual time=0.022..386.503 rows=500000 loops=3)
                           ->  Materialize  (cost=13702.07..13705.45 rows=8 width=180) (actual time=40.736..40.737 rows=1 loops=2)
                                 ->  Nested Loop  (cost=13702.07..13705.41 rows=8 width=180) (actual time=81.466..81.467 rows=1 loops=1)
                                       Join Filter: (((min(f0_9.lb_c_nationkey)) <= f1.ub_n_nationkey) AND ((max(f0_9.ub_c_nationkey)) >= f1.lb_n_nationkey))
                                       Rows Removed by Join Filter: 1
                                       ->  Finalize GroupAggregate  (cost=13699.60..13701.29 rows=25 width=564) (actual time=81.418..81.421 rows=2 loops=1)
                                             Group Key: (CASE WHEN (f0_9.c_nationkey >= 12) THEN 12 WHEN ((f0_9.c_nationkey < 12) AND (f0_9.c_nationkey >= 0)) THEN 0 ELSE 0 END)
                                             ->  Sort  (cost=13699.60..13699.72 rows=50 width=40) (actual time=81.409..81.410 rows=6 loops=1)
                                                   Sort Key: (CASE WHEN (f0_9.c_nationkey >= 12) THEN 12 WHEN ((f0_9.c_nationkey < 12) AND (f0_9.c_nationkey >= 0)) THEN 0 ELSE 0 END)
                                                   Sort Method: quicksort  Memory: 25kB
                                                   ->  Gather  (cost=13692.75..13698.19 rows=50 width=40) (actual time=81.283..81.440 rows=6 loops=1)
                                                         Workers Planned: 2
                                                         Workers Launched: 2
                                                         ->  Partial HashAggregate  (cost=12692.75..12693.19 rows=25 width=40) (actual time=77.471..77.472 rows=2 loops=3)
                                                               Group Key: CASE WHEN (f0_9.c_nationkey >= 12) THEN 12 WHEN ((f0_9.c_nationkey < 12) AND (f0_9.c_nationkey >= 0)) THEN 0 ELSE 0 END
                                                               ->  Parallel Seq Scan on customer_2_100_radb f0_9  (cost=0.00..11442.75 rows=62500 width=28) (actual time=0.033..50.744 rows=50000 loops=3)
                                       ->  Materialize  (cost=2.47..2.57 rows=3 width=132) (actual time=0.020..0.020 rows=1 loops=2)
                                             ->  Subquery Scan on f1  (cost=2.47..2.55 rows=3 width=132) (actual time=0.034..0.035 rows=1 loops=1)
                                                   ->  HashAggregate  (cost=2.47..2.52 rows=3 width=252) (actual time=0.033..0.034 rows=1 loops=1)
                                                         Group Key: CASE WHEN (f0_10.n_nationkey >= 12) THEN 12 WHEN ((f0_10.n_nationkey < 12) AND (f0_10.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                                         ->  Seq Scan on nation_2_100_radb f0_10  (cost=0.00..2.40 rows=3 width=36) (actual time=0.021..0.024 rows=1 loops=1)
                                                               Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text))
                                                               Rows Removed by Filter: 24
                     ->  Materialize  (cost=276880.47..363012.56 rows=1485394 width=36) (actual time=794.176..1115.326 rows=2 loops=2)
                           ->  Subquery Scan on f1_1  (cost=276880.47..343980.59 rows=1485394 width=36) (actual time=1588.348..2230.645 rows=2 loops=1)
                                 ->  GroupAggregate  (cost=276880.47..329126.65 rows=1485394 width=36) (actual time=1588.347..2230.642 rows=2 loops=1)
                                       Group Key: (CASE WHEN (f0_11.o_orderkey >= 300000) THEN 300000 WHEN ((f0_11.o_orderkey < 300000) AND (f0_11.o_orderkey >= 1)) THEN 1 ELSE 1 END)
                                       ->  Sort  (cost=276880.47..280630.72 rows=1500102 width=16) (actual time=1556.723..1836.668 rows=1500000 loops=1)
                                             Sort Key: (CASE WHEN (f0_11.o_orderkey >= 300000) THEN 300000 WHEN ((f0_11.o_orderkey < 300000) AND (f0_11.o_orderkey >= 1)) THEN 1 ELSE 1 END)
                                             Sort Method: external merge  Disk: 38192kB
                                             ->  Seq Scan on orders_2_100_radb f0_11  (cost=0.00..97357.79 rows=1500102 width=16) (actual time=0.008..1024.161 rows=1500000 loops=1)
               ->  Materialize  (cost=430123.26..430948.67 rows=10005 width=48) (actual time=749.232..749.234 rows=2 loops=4)
                     ->  Subquery Scan on f1_2  (cost=430123.26..430898.65 rows=10005 width=48) (actual time=2996.922..2996.930 rows=2 loops=1)
                           ->  Finalize GroupAggregate  (cost=430123.26..430798.60 rows=10005 width=48) (actual time=2996.920..2996.927 rows=2 loops=1)
                                 Group Key: (CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                 ->  Sort  (cost=430123.26..430173.29 rows=20010 width=40) (actual time=2996.910..2996.912 rows=6 loops=1)
                                       Sort Key: (CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                       Sort Method: quicksort  Memory: 25kB
                                       ->  Gather  (cost=426517.62..428693.70 rows=20010 width=40) (actual time=2996.632..2996.934 rows=6 loops=1)
                                             Workers Planned: 2
                                             Workers Launched: 2
                                             ->  Partial HashAggregate  (cost=425517.62..425692.70 rows=10005 width=40) (actual time=2992.535..2992.627 rows=2 loops=3)
                                                   Group Key: CASE WHEN (f0_12.l_suppkey >= 500) THEN 500 WHEN ((f0_12.l_suppkey < 500) AND (f0_12.l_suppkey >= 1)) THEN 1 ELSE 1 END
                                                   ->  Parallel Seq Scan on lineitem_2_100_radb f0_12  (cost=0.00..375513.56 rows=2500203 width=28) (actual time=0.032..1957.101 rows=2000405 loops=3)
         ->  Materialize  (cost=1014.57..1018.15 rows=17 width=180) (actual time=1.624..1.625 rows=2 loops=8)
               ->  Nested Loop  (cost=1014.57..1018.06 rows=17 width=180) (actual time=12.989..12.994 rows=2 loops=1)
                     Join Filter: ((f0_7.lb_n_nationkey <= (max(f0_13.ub_s_nationkey))) AND (f0_7.ub_n_nationkey >= (min(f0_13.lb_s_nationkey))))
                     ->  HashAggregate  (cost=1012.00..1012.44 rows=25 width=48) (actual time=12.937..12.939 rows=2 loops=1)
                           Group Key: CASE WHEN (f0_13.s_nationkey >= 12) THEN 12 WHEN ((f0_13.s_nationkey < 12) AND (f0_13.s_nationkey >= 0)) THEN 0 ELSE 0 END
                           ->  Seq Scan on supplier_2_100_radb f0_13  (cost=0.00..787.00 rows=10000 width=28) (actual time=0.010..7.801 rows=10000 loops=1)
                     ->  Materialize  (cost=2.57..2.76 rows=6 width=132) (actual time=0.024..0.025 rows=1 loops=2)
                           ->  Subquery Scan on f0_7  (cost=2.57..2.73 rows=6 width=132) (actual time=0.038..0.039 rows=1 loops=1)
                                 ->  HashAggregate  (cost=2.57..2.67 rows=6 width=132) (actual time=0.037..0.038 rows=1 loops=1)
                                       Group Key: CASE WHEN (f0_14.n_nationkey >= 12) THEN 12 WHEN ((f0_14.n_nationkey < 12) AND (f0_14.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                       ->  Seq Scan on nation_2_100_radb f0_14  (cost=0.00..2.42 rows=6 width=36) (actual time=0.022..0.026 rows=1 loops=1)
                                             Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text))
                                             Rows Removed by Filter: 24
 Planning time: 5.178 ms
 Execution time: 12073.123 ms
#+end_example
*** optimized after marking uncertain attrs as provenance
    #+begin_src sql
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", F0."c_name" AS "ub_c_name", F0."c_name" AS "lb_c_name", F0."c_address" AS "ub_c_address", F0."c_address" AS "lb_c_address", F0."c_nationkey" AS "ub_c_nationkey", F0."c_nationkey" AS "lb_c_nationkey", F0."c_phone" AS "ub_c_phone", F0."c_phone" AS "lb_c_phone", F0."c_acctbal" AS "ub_c_acctbal", F0."c_acctbal" AS "lb_c_acctbal", F0."c_mktsegment" AS "ub_c_mktsegment", F0."c_mktsegment" AS "lb_c_mktsegment", F0."c_comment" AS "ub_c_comment", F0."c_comment" AS "lb_c_comment", (CASE  WHEN (((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_c_custkey" = F0."lb_c_custkey")) AND (F0."ub_c_name" = F0."lb_c_name")) AND (F0."ub_c_address" = F0."lb_c_address")) AND (F0."ub_c_nationkey" = F0."lb_c_nationkey")) AND (F0."ub_c_phone" = F0."lb_c_phone")) AND (F0."ub_c_acctbal" = F0."lb_c_acctbal")) AND (F0."ub_c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."ub_c_comment" = F0."lb_c_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "customer_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (((((((((F0."tid" = F0."lb_tid") AND (F0."c_custkey" = F0."lb_c_custkey")) AND (F0."c_name" = F0."lb_c_name")) AND (F0."c_address" = F0."lb_c_address")) AND (F0."c_nationkey" = F0."lb_c_nationkey")) AND (F0."c_phone" = F0."lb_c_phone")) AND (F0."c_acctbal" = F0."lb_c_acctbal")) AND (F0."c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."c_comment" = F0."lb_c_comment"))) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_regionkey" AS "ub_n_regionkey", F0."n_regionkey" AS "lb_n_regionkey", F0."n_comment" AS "ub_n_comment", F0."n_comment" AS "lb_n_comment", (CASE  WHEN (((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) AND (F0."ub_n_name" = F0."lb_n_name")) AND (F0."ub_n_regionkey" = F0."lb_n_regionkey")) AND (F0."ub_n_comment" = F0."lb_n_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'CHINA') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('CHINA' = 'CHINA'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (((((F0."tid" = F0."lb_tid") AND (F0."n_nationkey" = F0."lb_n_nationkey")) AND (F0."n_name" = F0."lb_n_name")) AND (F0."n_regionkey" = F0."lb_n_regionkey")) AND (F0."n_comment" = F0."lb_n_comment"))) F1 ON ((F0."c_nationkey" = F1."n_nationkey")))) F0 JOIN (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderstatus" AS "ub_o_orderstatus", F0."o_orderstatus" AS "lb_o_orderstatus", F0."o_totalprice" AS "ub_o_totalprice", F0."o_totalprice" AS "lb_o_totalprice", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_orderpriority" AS "ub_o_orderpriority", F0."o_orderpriority" AS "lb_o_orderpriority", F0."o_clerk" AS "ub_o_clerk", F0."o_clerk" AS "lb_o_clerk", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", F0."o_comment" AS "ub_o_comment", F0."o_comment" AS "lb_o_comment", (CASE  WHEN ((((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_custkey" = F0."lb_o_custkey")) AND (F0."ub_o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."ub_o_totalprice" = F0."lb_o_totalprice")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."ub_o_clerk" = F0."lb_o_clerk")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) AND (F0."ub_o_comment" = F0."lb_o_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((((((((((F0."tid" = F0."lb_tid") AND (F0."o_orderkey" = F0."lb_o_orderkey")) AND (F0."o_custkey" = F0."lb_o_custkey")) AND (F0."o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."o_totalprice" = F0."lb_o_totalprice")) AND (F0."o_orderdate" = F0."lb_o_orderdate")) AND (F0."o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."o_clerk" = F0."lb_o_clerk")) AND (F0."o_shippriority" = F0."lb_o_shippriority")) AND (F0."o_comment" = F0."lb_o_comment"))) F1 ON ((F0."c_custkey" = F1."o_custkey")))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."ub_n_name" = F0."lb_n_name") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."n_nationkey" = F0."lb_n_nationkey") AND (F0."n_name" = F0."lb_n_name"))) F0 JOIN (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."s_suppkey" AS "ub_s_suppkey", F0."s_suppkey" AS "lb_s_suppkey", F0."s_nationkey" AS "ub_s_nationkey", F0."s_nationkey" AS "lb_s_nationkey", (CASE  WHEN ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F0."ub_s_nationkey" = F0."lb_s_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "supplier_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."s_suppkey" = F0."lb_s_suppkey") AND (F0."s_nationkey" = F0."lb_s_nationkey"))) F1 ON ((F0."n_nationkey" = F1."s_nationkey")))) F0 JOIN (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", F0."l_suppkey" AS "ub_l_suppkey", F0."l_suppkey" AS "lb_l_suppkey", (CASE  WHEN ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F0."ub_l_suppkey" = F0."lb_l_suppkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE ((F0."l_orderkey" = F0."lb_l_orderkey") AND (F0."l_suppkey" = F0."lb_l_suppkey"))) F1 ON ((F0."s_suppkey" = F1."l_suppkey")))) F0 JOIN (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", (CASE  WHEN (F0."ub_o_orderkey" = F0."lb_o_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
      FROM (
      SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "orders_2_100_radb" AS F0) F0
      WHERE (F0."bst_r" > 0)) F0
      WHERE (F0."o_orderkey" = F0."lb_o_orderkey")) F1 ON ((F0."l_orderkey" = F1."o_orderkey")))) F1 ON ((F0."o1" = F1."o2"))) UNION ALL
      SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o1" = F1."o2") AND ((F0."ub_o1" = F0."lb_o1") AND (F1."ub_o2" = F1."lb_o2"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o1" = F1."o2") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_nationkey" = F1."n_nationkey") AND ((F0."ub_c_nationkey" = F0."lb_c_nationkey") AND (F1."ub_n_nationkey" = F1."lb_n_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_nationkey" = F1."n_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."tid") AS "tid", min(F0."c_custkey") AS "c_custkey", min(F0."c_name") AS "c_name", min(F0."c_address") AS "c_address", (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "c_nationkey", min(F0."c_phone") AS "c_phone", min(F0."c_acctbal") AS "c_acctbal", min(F0."c_mktsegment") AS "c_mktsegment", min(F0."c_comment") AS "c_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", max(F0."ub_c_name") AS "ub_c_name", min(F0."lb_c_name") AS "lb_c_name", max(F0."ub_c_address") AS "ub_c_address", min(F0."lb_c_address") AS "lb_c_address", max(F0."ub_c_nationkey") AS "ub_c_nationkey", min(F0."lb_c_nationkey") AS "lb_c_nationkey", max(F0."ub_c_phone") AS "ub_c_phone", min(F0."lb_c_phone") AS "lb_c_phone", max(F0."ub_c_acctbal") AS "ub_c_acctbal", min(F0."lb_c_acctbal") AS "lb_c_acctbal", max(F0."ub_c_mktsegment") AS "ub_c_mktsegment", min(F0."lb_c_mktsegment") AS "lb_c_mktsegment", max(F0."ub_c_comment") AS "ub_c_comment", min(F0."lb_c_comment") AS "lb_c_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "customer_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."tid") AS "tid", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", min(F0."n_name") AS "n_name", min(F0."n_regionkey") AS "n_regionkey", min(F0."n_comment") AS "n_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_regionkey") AS "ub_n_regionkey", min(F0."lb_n_regionkey") AS "lb_n_regionkey", max(F0."ub_n_comment") AS "ub_n_comment", min(F0."lb_n_comment") AS "lb_n_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_c_nationkey" <= F1."ub_n_nationkey") AND (F0."ub_c_nationkey" >= F1."lb_n_nationkey"))))) F0 JOIN (
      SELECT min(F0."tid") AS "tid", min(F0."o_orderkey") AS "o_orderkey", (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderstatus") AS "o_orderstatus", min(F0."o_totalprice") AS "o_totalprice", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_orderpriority") AS "o_orderpriority", min(F0."o_clerk") AS "o_clerk", min(F0."o_shippriority") AS "o_shippriority", min(F0."o_comment") AS "o_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderstatus") AS "ub_o_orderstatus", min(F0."lb_o_orderstatus") AS "lb_o_orderstatus", max(F0."ub_o_totalprice") AS "ub_o_totalprice", min(F0."lb_o_totalprice") AS "lb_o_totalprice", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_orderpriority") AS "ub_o_orderpriority", min(F0."lb_o_orderpriority") AS "lb_o_orderpriority", max(F0."ub_o_clerk") AS "ub_o_clerk", min(F0."lb_o_clerk") AS "lb_o_clerk", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", max(F0."ub_o_comment") AS "ub_o_comment", min(F0."lb_o_comment") AS "lb_o_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))) F0 JOIN (
      SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."l_orderkey" = F1."o_orderkey") AND ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F1."ub_o_orderkey" = F1."lb_o_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."l_orderkey" = F1."o_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."s_suppkey" = F1."l_suppkey") AND ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F1."ub_l_suppkey" = F1."lb_l_suppkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."s_suppkey" = F1."l_suppkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."n_nationkey" = F1."s_nationkey") AND ((F0."ub_n_nationkey" = F0."lb_n_nationkey") AND (F1."ub_s_nationkey" = F1."lb_s_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."n_nationkey" = F1."s_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
      FROM ((
      SELECT min(F0."n_name") AS "n_name", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END)) AS "pos_r"
      FROM (
      SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
      FROM "nation_2_100_radb" AS F0) F0
      WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))
      GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
      SELECT min(F0."s_suppkey") AS "s_suppkey", (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "s_nationkey", max(F0."ub_s_suppkey") AS "ub_s_suppkey", min(F0."lb_s_suppkey") AS "lb_s_suppkey", max(F0."ub_s_nationkey") AS "ub_s_nationkey", min(F0."lb_s_nationkey") AS "lb_s_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "supplier_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_n_nationkey" <= F1."ub_s_nationkey") AND (F0."ub_n_nationkey" >= F1."lb_s_nationkey"))))) F0 JOIN (
      SELECT min(F0."l_orderkey") AS "l_orderkey", (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END) AS "l_suppkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", max(F0."ub_l_suppkey") AS "ub_l_suppkey", min(F0."lb_l_suppkey") AS "lb_l_suppkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "lineitem_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_s_suppkey" <= F1."ub_l_suppkey") AND (F0."ub_s_suppkey" >= F1."lb_l_suppkey"))))) F0 JOIN (
      SELECT (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "o_orderkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
      FROM "orders_2_100_radb" AS F0
      GROUP BY (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_l_orderkey" <= F1."ub_o_orderkey") AND (F0."ub_l_orderkey" >= F1."lb_o_orderkey"))))) F1 ON (((F0."lb_o1" <= F1."ub_o2") AND (F0."ub_o1" >= F1."lb_o2"))));
    #+end_src
*** normal query
    #+begin_src
SELECT U1.n_name as n_name, U2.n_name as n_name2 from ((SELECT n_name, o_orderkey FROM customer_2_100_bg c, orders_2_100_bg o, nation_2_100_bg n WHERE c_nationkey = n_nationkey AND c_custkey = o_custkey AND n_name = 'CHINA') U1 JOIN (SELECT n_name, o_orderkey FROM supplier_2_100_bg s, orders_2_100_bg o, lineitem_2_100_bg l, nation_2_100_bg n WHERE s_nationkey = n_nationkey AND o_orderkey = l_orderkey AND s_suppkey = l_suppkey AND n_name = 'GERMANY') U2 ON u1.o_orderkey=u2.o_orderkey);
    #+end_src
- postgres plan
#+begin_example
                                                          QUERY PLAN
  ---------------------------------------------------------------------------------------------------------------------------
   Hash Join  (cost=213587.46..260894.16 rows=10599 width=16)
     Hash Cond: (o_1.o_orderkey = l.l_orderkey)
     ->  Seq Scan on orders_2_100_bg o_1  (cost=0.00..41579.00 rows=1500000 width=4)
     ->  Hash  (cost=213461.17..213461.17 rows=10103 width=24)
           ->  Gather  (cost=55879.93..213461.17 rows=10103 width=24)
                 Workers Planned: 2
                 ->  Hash Join  (cost=54879.93..211450.87 rows=4210 width=24)
                       Hash Cond: (l.l_orderkey = o.o_orderkey)
                       ->  Hash Join  (cost=370.82..156150.03 rows=99952 width=12)
                             Hash Cond: (l.l_suppkey = s.s_suppkey)
                             ->  Parallel Seq Scan on lineitem_2_100_bg l  (cost=0.00..145402.05 rows=2500705 width=8)
                             ->  Hash  (cost=365.82..365.82 rows=400 width=12)
                                   ->  Hash Join  (cost=1.32..365.82 rows=400 width=12)
                                         Hash Cond: (s.s_nationkey = n_1.n_nationkey)
                                         ->  Seq Scan on supplier_2_100_bg s  (cost=0.00..323.00 rows=10000 width=8)
                                         ->  Hash  (cost=1.31..1.31 rows=1 width=12)
                                               ->  Seq Scan on nation_2_100_bg n_1  (cost=0.00..1.31 rows=1 width=12)
                                                     Filter: ((n_name)::text = 'GERMANY'::text)
                       ->  Hash  (cost=53732.28..53732.28 rows=62146 width=12)
                             ->  Hash Join  (cost=5906.82..53732.28 rows=62146 width=12)
                                   Hash Cond: (o.o_custkey = c.c_custkey)
                                   ->  Seq Scan on orders_2_100_bg o  (cost=0.00..41579.00 rows=1500000 width=8)
                                   ->  Hash  (cost=5831.82..5831.82 rows=6000 width=12)
                                         ->  Hash Join  (cost=1.32..5831.82 rows=6000 width=12)
                                               Hash Cond: (c.c_nationkey = n.n_nationkey)
                                               ->  Seq Scan on customer_2_100_bg c  (cost=0.00..5208.00 rows=150000 width=8)
                                               ->  Hash  (cost=1.31..1.31 rows=1 width=12)
                                                     ->  Seq Scan on nation_2_100_bg n  (cost=0.00..1.31 rows=1 width=12)
                                                           Filter: ((n_name)::text = 'CHINA'::text)
#+end_example
*** optimized
    #+begin_src sql
SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", F0."c_name" AS "ub_c_name", F0."c_name" AS "lb_c_name", F0."c_address" AS "ub_c_address", F0."c_address" AS "lb_c_address", F0."c_nationkey" AS "ub_c_nationkey", F0."c_nationkey" AS "lb_c_nationkey", F0."c_phone" AS "ub_c_phone", F0."c_phone" AS "lb_c_phone", F0."c_acctbal" AS "ub_c_acctbal", F0."c_acctbal" AS "lb_c_acctbal", F0."c_mktsegment" AS "ub_c_mktsegment", F0."c_mktsegment" AS "lb_c_mktsegment", F0."c_comment" AS "ub_c_comment", F0."c_comment" AS "lb_c_comment", (CASE  WHEN (((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_c_custkey" = F0."lb_c_custkey")) AND (F0."ub_c_name" = F0."lb_c_name")) AND (F0."ub_c_address" = F0."lb_c_address")) AND (F0."ub_c_nationkey" = F0."lb_c_nationkey")) AND (F0."ub_c_phone" = F0."lb_c_phone")) AND (F0."ub_c_acctbal" = F0."lb_c_acctbal")) AND (F0."ub_c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."ub_c_comment" = F0."lb_c_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "customer_2_100_radb" AS F0) F0
WHERE (F0."bst_r" > 0)) F0
WHERE (((((((((F0."tid" = F0."lb_tid") AND (F0."c_custkey" = F0."lb_c_custkey")) AND (F0."c_name" = F0."lb_c_name")) AND (F0."c_address" = F0."lb_c_address")) AND (F0."c_nationkey" = F0."lb_c_nationkey")) AND (F0."c_phone" = F0."lb_c_phone")) AND (F0."c_acctbal" = F0."lb_c_acctbal")) AND (F0."c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."c_comment" = F0."lb_c_comment"))) F0 JOIN (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_regionkey" AS "ub_n_regionkey", F0."n_regionkey" AS "lb_n_regionkey", F0."n_comment" AS "ub_n_comment", F0."n_comment" AS "lb_n_comment", (CASE  WHEN (((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) AND (F0."ub_n_name" = F0."lb_n_name")) AND (F0."ub_n_regionkey" = F0."lb_n_regionkey")) AND (F0."ub_n_comment" = F0."lb_n_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'CHINA') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('CHINA' = 'CHINA'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0) F0
WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))) F0
WHERE (F0."bst_r" > 0)) F0
WHERE (((((F0."tid" = F0."lb_tid") AND (F0."n_nationkey" = F0."lb_n_nationkey")) AND (F0."n_name" = F0."lb_n_name")) AND (F0."n_regionkey" = F0."lb_n_regionkey")) AND (F0."n_comment" = F0."lb_n_comment"))) F1 ON ((F0."c_nationkey" = F1."n_nationkey")))) F0 JOIN (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderstatus" AS "ub_o_orderstatus", F0."o_orderstatus" AS "lb_o_orderstatus", F0."o_totalprice" AS "ub_o_totalprice", F0."o_totalprice" AS "lb_o_totalprice", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_orderpriority" AS "ub_o_orderpriority", F0."o_orderpriority" AS "lb_o_orderpriority", F0."o_clerk" AS "ub_o_clerk", F0."o_clerk" AS "lb_o_clerk", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", F0."o_comment" AS "ub_o_comment", F0."o_comment" AS "lb_o_comment", (CASE  WHEN ((((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_custkey" = F0."lb_o_custkey")) AND (F0."ub_o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."ub_o_totalprice" = F0."lb_o_totalprice")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."ub_o_clerk" = F0."lb_o_clerk")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) AND (F0."ub_o_comment" = F0."lb_o_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0) F0
WHERE (F0."bst_r" > 0)) F0
WHERE ((((((((((F0."tid" = F0."lb_tid") AND (F0."o_orderkey" = F0."lb_o_orderkey")) AND (F0."o_custkey" = F0."lb_o_custkey")) AND (F0."o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."o_totalprice" = F0."lb_o_totalprice")) AND (F0."o_orderdate" = F0."lb_o_orderdate")) AND (F0."o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."o_clerk" = F0."lb_o_clerk")) AND (F0."o_shippriority" = F0."lb_o_shippriority")) AND (F0."o_comment" = F0."lb_o_comment"))) F1 ON ((F0."c_custkey" = F1."o_custkey")))) F0 JOIN (
SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."ub_n_name" = F0."lb_n_name") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0) F0
WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))) F0
WHERE (F0."bst_r" > 0)) F0
WHERE ((F0."n_nationkey" = F0."lb_n_nationkey") AND (F0."n_name" = F0."lb_n_name"))) F0 JOIN (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."s_suppkey" AS "ub_s_suppkey", F0."s_suppkey" AS "lb_s_suppkey", F0."s_nationkey" AS "ub_s_nationkey", F0."s_nationkey" AS "lb_s_nationkey", (CASE  WHEN ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F0."ub_s_nationkey" = F0."lb_s_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "supplier_2_100_radb" AS F0) F0
WHERE (F0."bst_r" > 0)) F0
WHERE ((F0."s_suppkey" = F0."lb_s_suppkey") AND (F0."s_nationkey" = F0."lb_s_nationkey"))) F1 ON ((F0."n_nationkey" = F1."s_nationkey")))) F0 JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", F0."l_suppkey" AS "ub_l_suppkey", F0."l_suppkey" AS "lb_l_suppkey", (CASE  WHEN ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F0."ub_l_suppkey" = F0."lb_l_suppkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "lineitem_2_100_radb" AS F0) F0
WHERE (F0."bst_r" > 0)) F0
WHERE ((F0."l_orderkey" = F0."lb_l_orderkey") AND (F0."l_suppkey" = F0."lb_l_suppkey"))) F1 ON ((F0."s_suppkey" = F1."l_suppkey")))) F0 JOIN (
SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", (CASE  WHEN (F0."ub_o_orderkey" = F0."lb_o_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0) F0
WHERE (F0."bst_r" > 0)) F0
WHERE (F0."o_orderkey" = F0."lb_o_orderkey")) F1 ON ((F0."l_orderkey" = F1."o_orderkey")))) F1 ON ((F0."o1" = F1."o2"))) UNION ALL
SELECT F0."n1" AS "n1", F1."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o1" = F1."o2") AND ((F0."ub_o1" = F0."lb_o1") AND (F1."ub_o2" = F1."lb_o2"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o1" = F1."o2") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n1", F1."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F1."ub_o_orderkey" AS "ub_o1", F1."lb_o_orderkey" AS "lb_o1", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_nationkey" = F1."n_nationkey") AND ((F0."ub_c_nationkey" = F0."lb_c_nationkey") AND (F1."ub_n_nationkey" = F1."lb_n_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_nationkey" = F1."n_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT min(F0."tid") AS "tid", min(F0."c_custkey") AS "c_custkey", min(F0."c_name") AS "c_name", min(F0."c_address") AS "c_address", (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "c_nationkey", min(F0."c_phone") AS "c_phone", min(F0."c_acctbal") AS "c_acctbal", min(F0."c_mktsegment") AS "c_mktsegment", min(F0."c_comment") AS "c_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", max(F0."ub_c_name") AS "ub_c_name", min(F0."lb_c_name") AS "lb_c_name", max(F0."ub_c_address") AS "ub_c_address", min(F0."lb_c_address") AS "lb_c_address", max(F0."ub_c_nationkey") AS "ub_c_nationkey", min(F0."lb_c_nationkey") AS "lb_c_nationkey", max(F0."ub_c_phone") AS "ub_c_phone", min(F0."lb_c_phone") AS "lb_c_phone", max(F0."ub_c_acctbal") AS "ub_c_acctbal", min(F0."lb_c_acctbal") AS "lb_c_acctbal", max(F0."ub_c_mktsegment") AS "ub_c_mktsegment", min(F0."lb_c_mktsegment") AS "lb_c_mktsegment", max(F0."ub_c_comment") AS "ub_c_comment", min(F0."lb_c_comment") AS "lb_c_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
FROM "customer_2_100_radb" AS F0
GROUP BY (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
SELECT min(F0."tid") AS "tid", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", min(F0."n_name") AS "n_name", min(F0."n_regionkey") AS "n_regionkey", min(F0."n_comment") AS "n_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_regionkey") AS "ub_n_regionkey", min(F0."lb_n_regionkey") AS "lb_n_regionkey", max(F0."ub_n_comment") AS "ub_n_comment", min(F0."lb_n_comment") AS "lb_n_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'CHINA') THEN 1 ELSE 0 END)) AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0) F0
WHERE ((F0."lb_n_name" <= 'CHINA') AND (F0."ub_n_name" >= 'CHINA'))
GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_c_nationkey" <= F1."ub_n_nationkey") AND (F0."ub_c_nationkey" >= F1."lb_n_nationkey"))))) F0 JOIN (
SELECT min(F0."tid") AS "tid", min(F0."o_orderkey") AS "o_orderkey", (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderstatus") AS "o_orderstatus", min(F0."o_totalprice") AS "o_totalprice", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_orderpriority") AS "o_orderpriority", min(F0."o_clerk") AS "o_clerk", min(F0."o_shippriority") AS "o_shippriority", min(F0."o_comment") AS "o_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderstatus") AS "ub_o_orderstatus", min(F0."lb_o_orderstatus") AS "lb_o_orderstatus", max(F0."ub_o_totalprice") AS "ub_o_totalprice", min(F0."lb_o_totalprice") AS "lb_o_totalprice", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_orderpriority") AS "ub_o_orderpriority", min(F0."lb_o_orderpriority") AS "lb_o_orderpriority", max(F0."ub_o_clerk") AS "ub_o_clerk", min(F0."lb_o_clerk") AS "lb_o_clerk", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", max(F0."ub_o_comment") AS "ub_o_comment", min(F0."lb_o_comment") AS "lb_o_comment", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
FROM "orders_2_100_radb" AS F0
GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))) F0 JOIN (
SELECT F0."n_name" AS "n2", F1."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F1."ub_o_orderkey" AS "ub_o2", F1."lb_o_orderkey" AS "lb_o2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."l_orderkey" = F1."o_orderkey") AND ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F1."ub_o_orderkey" = F1."lb_o_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."l_orderkey" = F1."o_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."s_suppkey" = F1."l_suppkey") AND ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F1."ub_l_suppkey" = F1."lb_l_suppkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."s_suppkey" = F1."l_suppkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."n_nationkey" = F1."s_nationkey") AND ((F0."ub_n_nationkey" = F0."lb_n_nationkey") AND (F1."ub_s_nationkey" = F1."lb_s_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."n_nationkey" = F1."s_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT min(F0."n_name") AS "n_name", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END)) AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0) F0
WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))
GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
SELECT min(F0."s_suppkey") AS "s_suppkey", (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "s_nationkey", max(F0."ub_s_suppkey") AS "ub_s_suppkey", min(F0."lb_s_suppkey") AS "lb_s_suppkey", max(F0."ub_s_nationkey") AS "ub_s_nationkey", min(F0."lb_s_nationkey") AS "lb_s_nationkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
FROM "supplier_2_100_radb" AS F0
GROUP BY (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_n_nationkey" <= F1."ub_s_nationkey") AND (F0."ub_n_nationkey" >= F1."lb_s_nationkey"))))) F0 JOIN (
SELECT min(F0."l_orderkey") AS "l_orderkey", (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END) AS "l_suppkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", max(F0."ub_l_suppkey") AS "ub_l_suppkey", min(F0."lb_l_suppkey") AS "lb_l_suppkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
FROM "lineitem_2_100_radb" AS F0
GROUP BY (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_s_suppkey" <= F1."ub_l_suppkey") AND (F0."ub_s_suppkey" >= F1."lb_l_suppkey"))))) F0 JOIN (
SELECT (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "o_orderkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum(F0."bst_r") AS "pos_r"
FROM "orders_2_100_radb" AS F0
GROUP BY (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_l_orderkey" <= F1."ub_o_orderkey") AND (F0."ub_l_orderkey" >= F1."lb_o_orderkey"))))) F1 ON (((F0."lb_o1" <= F1."ub_o2") AND (F0."ub_o1" >= F1."lb_o2"))));
    #+end_src
- postgres plan
#+begin_example

#+end_example
*** non-optimized
    #+begin_src sql
WITH _temp_view_2 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "customer_2_100_radb" AS F0),
_temp_view_4 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0),
_temp_view_3 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'IRAQ') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('IRAQ' = 'IRAQ'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'IRAQ') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_4) F0) F0
WHERE ((F0."lb_n_name" <= 'IRAQ') AND (F0."ub_n_name" >= 'IRAQ'))),
_temp_view_5 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0),
_temp_view_1 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid1" AS "tid1", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F1."tid" AS "tid2", F1."o_orderkey" AS "o_orderkey", F1."o_custkey" AS "o_custkey", F1."o_orderstatus" AS "o_orderstatus", F1."o_totalprice" AS "o_totalprice", F1."o_orderdate" AS "o_orderdate", F1."o_orderpriority" AS "o_orderpriority", F1."o_clerk" AS "o_clerk", F1."o_shippriority" AS "o_shippriority", F1."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."ub_tid1" AS "ub_tid1", F0."lb_tid1" AS "lb_tid1", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F1."ub_tid" AS "ub_tid2", F1."lb_tid" AS "lb_tid2", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_custkey" AS "ub_o_custkey", F1."lb_o_custkey" AS "lb_o_custkey", F1."ub_o_orderstatus" AS "ub_o_orderstatus", F1."lb_o_orderstatus" AS "lb_o_orderstatus", F1."ub_o_totalprice" AS "ub_o_totalprice", F1."lb_o_totalprice" AS "lb_o_totalprice", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_orderpriority" AS "ub_o_orderpriority", F1."lb_o_orderpriority" AS "lb_o_orderpriority", F1."ub_o_clerk" AS "ub_o_clerk", F1."lb_o_clerk" AS "lb_o_clerk", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", F1."ub_o_comment" AS "ub_o_comment", F1."lb_o_comment" AS "lb_o_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", F0."c_name" AS "ub_c_name", F0."c_name" AS "lb_c_name", F0."c_address" AS "ub_c_address", F0."c_address" AS "lb_c_address", F0."c_nationkey" AS "ub_c_nationkey", F0."c_nationkey" AS "lb_c_nationkey", F0."c_phone" AS "ub_c_phone", F0."c_phone" AS "lb_c_phone", F0."c_acctbal" AS "ub_c_acctbal", F0."c_acctbal" AS "lb_c_acctbal", F0."c_mktsegment" AS "ub_c_mktsegment", F0."c_mktsegment" AS "lb_c_mktsegment", F0."c_comment" AS "ub_c_comment", F0."c_comment" AS "lb_c_comment", (CASE  WHEN (((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_c_custkey" = F0."lb_c_custkey")) AND (F0."ub_c_name" = F0."lb_c_name")) AND (F0."ub_c_address" = F0."lb_c_address")) AND (F0."ub_c_nationkey" = F0."lb_c_nationkey")) AND (F0."ub_c_phone" = F0."lb_c_phone")) AND (F0."ub_c_acctbal" = F0."lb_c_acctbal")) AND (F0."ub_c_mktsegment" = F0."lb_c_mktsegment")) AND (F0."ub_c_comment" = F0."lb_c_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_2) F0) F0
WHERE (F0."bst_r" > 0)) F0 JOIN (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_regionkey" AS "ub_n_regionkey", F0."n_regionkey" AS "lb_n_regionkey", F0."n_comment" AS "ub_n_comment", F0."n_comment" AS "lb_n_comment", (CASE  WHEN (((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) AND (F0."ub_n_name" = F0."lb_n_name")) AND (F0."ub_n_regionkey" = F0."lb_n_regionkey")) AND (F0."ub_n_comment" = F0."lb_n_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_3) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."c_nationkey" = F1."n_nationkey")))) F0 JOIN (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."tid" AS "ub_tid", F0."tid" AS "lb_tid", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderstatus" AS "ub_o_orderstatus", F0."o_orderstatus" AS "lb_o_orderstatus", F0."o_totalprice" AS "ub_o_totalprice", F0."o_totalprice" AS "lb_o_totalprice", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_orderpriority" AS "ub_o_orderpriority", F0."o_orderpriority" AS "lb_o_orderpriority", F0."o_clerk" AS "ub_o_clerk", F0."o_clerk" AS "lb_o_clerk", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", F0."o_comment" AS "ub_o_comment", F0."o_comment" AS "lb_o_comment", (CASE  WHEN ((((((((((F0."ub_tid" = F0."lb_tid") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_custkey" = F0."lb_o_custkey")) AND (F0."ub_o_orderstatus" = F0."lb_o_orderstatus")) AND (F0."ub_o_totalprice" = F0."lb_o_totalprice")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_orderpriority" = F0."lb_o_orderpriority")) AND (F0."ub_o_clerk" = F0."lb_o_clerk")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) AND (F0."ub_o_comment" = F0."lb_o_comment")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_5) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."c_custkey" = F1."o_custkey")))),
_temp_view_8 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0),
_temp_view_7 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_8) F0) F0
WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))),
_temp_view_10 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_name" AS "ub_s_name", F0."lb_s_name" AS "lb_s_name", F0."ub_s_address" AS "ub_s_address", F0."lb_s_address" AS "lb_s_address", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_s_phone" AS "ub_s_phone", F0."lb_s_phone" AS "lb_s_phone", F0."ub_s_acctbal" AS "ub_s_acctbal", F0."lb_s_acctbal" AS "lb_s_acctbal", F0."ub_s_comment" AS "ub_s_comment", F0."lb_s_comment" AS "lb_s_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "supplier_2_100_radb" AS F0),
_temp_view_9 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_name" AS "ub_s_name", F0."lb_s_name" AS "lb_s_name", F0."ub_s_address" AS "ub_s_address", F0."lb_s_address" AS "lb_s_address", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_s_phone" AS "ub_s_phone", F0."lb_s_phone" AS "lb_s_phone", F0."ub_s_acctbal" AS "ub_s_acctbal", F0."lb_s_acctbal" AS "lb_s_acctbal", F0."ub_s_comment" AS "ub_s_comment", F0."lb_s_comment" AS "lb_s_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_10) F0),
_temp_view_12 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "lineitem_2_100_radb" AS F0),
_temp_view_11 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_12) F0),
_temp_view_14 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0),
_temp_view_13 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_14) F0),
_temp_view_6 AS (
SELECT /*+ materialize */ F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F1."o_orderkey" AS "o_orderkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "ub_n_name", F0."n_name" AS "lb_n_name", F0."n_nationkey" AS "ub_n_nationkey", F0."n_nationkey" AS "lb_n_nationkey", (CASE  WHEN ((F0."ub_n_name" = F0."lb_n_name") AND (F0."ub_n_nationkey" = F0."lb_n_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_7) F0) F0
WHERE (F0."bst_r" > 0)) F0 JOIN (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."s_suppkey" AS "ub_s_suppkey", F0."s_suppkey" AS "lb_s_suppkey", F0."s_nationkey" AS "ub_s_nationkey", F0."s_nationkey" AS "lb_s_nationkey", (CASE  WHEN ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F0."ub_s_nationkey" = F0."lb_s_nationkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_9) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."n_nationkey" = F1."s_nationkey")))) F0 JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", F0."l_suppkey" AS "ub_l_suppkey", F0."l_suppkey" AS "lb_l_suppkey", (CASE  WHEN ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F0."ub_l_suppkey" = F0."lb_l_suppkey")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_11) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."s_suppkey" = F1."l_suppkey")))) F0 JOIN (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", (CASE  WHEN (F0."ub_o_orderkey" = F0."lb_o_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_13) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."l_orderkey" = F1."o_orderkey")))),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."n1" AS "n1", F0."o1" AS "o1", F1."n2" AS "n2", F1."o2" AS "o2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F0."ub_o1" AS "ub_o1", F0."lb_o1" AS "lb_o1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", F1."ub_o2" AS "ub_o2", F1."lb_o2" AS "lb_o2", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n1", F0."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F0."ub_o_orderkey" AS "ub_o1", F0."lb_o_orderkey" AS "lb_o1", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_1) F0) F0 JOIN (
SELECT F0."n_name" AS "n2", F0."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F0."ub_o_orderkey" AS "ub_o2", F0."lb_o_orderkey" AS "lb_o2", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_6) F0) F1 ON ((F0."o1" = F1."o2")))),
_temp_view_19 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "customer_2_100_radb" AS F0),
_temp_view_18 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_19) F0),
_temp_view_17 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_18) F0),
_temp_view_23 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0),
_temp_view_22 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'IRAQ') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('IRAQ' = 'IRAQ'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'IRAQ') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_23) F0) F0
WHERE ((F0."lb_n_name" <= 'IRAQ') AND (F0."ub_n_name" >= 'IRAQ'))),
_temp_view_21 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_22) F0),
_temp_view_20 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_21) F0),
_temp_view_26 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0),
_temp_view_25 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_26) F0),
_temp_view_24 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_25) F0),
_temp_view_16 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."tid1" AS "tid1", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F1."tid" AS "tid2", F1."o_orderkey" AS "o_orderkey", F1."o_custkey" AS "o_custkey", F1."o_orderstatus" AS "o_orderstatus", F1."o_totalprice" AS "o_totalprice", F1."o_orderdate" AS "o_orderdate", F1."o_orderpriority" AS "o_orderpriority", F1."o_clerk" AS "o_clerk", F1."o_shippriority" AS "o_shippriority", F1."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."ub_tid1" AS "ub_tid1", F0."lb_tid1" AS "lb_tid1", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F1."ub_tid" AS "ub_tid2", F1."lb_tid" AS "lb_tid2", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_custkey" AS "ub_o_custkey", F1."lb_o_custkey" AS "lb_o_custkey", F1."ub_o_orderstatus" AS "ub_o_orderstatus", F1."lb_o_orderstatus" AS "lb_o_orderstatus", F1."ub_o_totalprice" AS "ub_o_totalprice", F1."lb_o_totalprice" AS "lb_o_totalprice", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_orderpriority" AS "ub_o_orderpriority", F1."lb_o_orderpriority" AS "lb_o_orderpriority", F1."ub_o_clerk" AS "ub_o_clerk", F1."lb_o_clerk" AS "lb_o_clerk", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", F1."ub_o_comment" AS "ub_o_comment", F1."lb_o_comment" AS "lb_o_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F1."tid" AS "tid1", F1."n_nationkey" AS "n_nationkey", F1."n_name" AS "n_name", F1."n_regionkey" AS "n_regionkey", F1."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F1."ub_tid" AS "ub_tid1", F1."lb_tid" AS "lb_tid1", F1."ub_n_nationkey" AS "ub_n_nationkey", F1."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_n_name" AS "ub_n_name", F1."lb_n_name" AS "lb_n_name", F1."ub_n_regionkey" AS "ub_n_regionkey", F1."lb_n_regionkey" AS "lb_n_regionkey", F1."ub_n_comment" AS "ub_n_comment", F1."lb_n_comment" AS "lb_n_comment", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_nationkey" = F1."n_nationkey") AND ((F0."ub_c_nationkey" = F0."lb_c_nationkey") AND (F1."ub_n_nationkey" = F1."lb_n_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_nationkey" = F1."n_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT min(F0."tid") AS "tid", min(F0."c_custkey") AS "c_custkey", min(F0."c_name") AS "c_name", min(F0."c_address") AS "c_address", (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "c_nationkey", min(F0."c_phone") AS "c_phone", min(F0."c_acctbal") AS "c_acctbal", min(F0."c_mktsegment") AS "c_mktsegment", min(F0."c_comment") AS "c_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", max(F0."ub_c_name") AS "ub_c_name", min(F0."lb_c_name") AS "lb_c_name", max(F0."ub_c_address") AS "ub_c_address", min(F0."lb_c_address") AS "lb_c_address", max(F0."ub_c_nationkey") AS "ub_c_nationkey", min(F0."lb_c_nationkey") AS "lb_c_nationkey", max(F0."ub_c_phone") AS "ub_c_phone", min(F0."lb_c_phone") AS "lb_c_phone", max(F0."ub_c_acctbal") AS "ub_c_acctbal", min(F0."lb_c_acctbal") AS "lb_c_acctbal", max(F0."ub_c_mktsegment") AS "ub_c_mktsegment", min(F0."lb_c_mktsegment") AS "lb_c_mktsegment", max(F0."ub_c_comment") AS "ub_c_comment", min(F0."lb_c_comment") AS "lb_c_comment", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_17) F0
GROUP BY (CASE  WHEN (F0."c_nationkey" >= 12) THEN 12 WHEN ((F0."c_nationkey" < 12) AND (F0."c_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
SELECT min(F0."tid") AS "tid", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", min(F0."n_name") AS "n_name", min(F0."n_regionkey") AS "n_regionkey", min(F0."n_comment") AS "n_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_regionkey") AS "ub_n_regionkey", min(F0."lb_n_regionkey") AS "lb_n_regionkey", max(F0."ub_n_comment") AS "ub_n_comment", min(F0."lb_n_comment") AS "lb_n_comment", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_20) F0
GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_c_nationkey" <= F1."ub_n_nationkey") AND (F0."ub_c_nationkey" >= F1."lb_n_nationkey"))))) F0 JOIN (
SELECT min(F0."tid") AS "tid", min(F0."o_orderkey") AS "o_orderkey", (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderstatus") AS "o_orderstatus", min(F0."o_totalprice") AS "o_totalprice", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_orderpriority") AS "o_orderpriority", min(F0."o_clerk") AS "o_clerk", min(F0."o_shippriority") AS "o_shippriority", min(F0."o_comment") AS "o_comment", max(F0."ub_tid") AS "ub_tid", min(F0."lb_tid") AS "lb_tid", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderstatus") AS "ub_o_orderstatus", min(F0."lb_o_orderstatus") AS "lb_o_orderstatus", max(F0."ub_o_totalprice") AS "ub_o_totalprice", min(F0."lb_o_totalprice") AS "lb_o_totalprice", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_orderpriority") AS "ub_o_orderpriority", min(F0."lb_o_orderpriority") AS "lb_o_orderpriority", max(F0."ub_o_clerk") AS "ub_o_clerk", min(F0."lb_o_clerk") AS "lb_o_clerk", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", max(F0."ub_o_comment") AS "ub_o_comment", min(F0."lb_o_comment") AS "lb_o_comment", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_24) F0
GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))),
_temp_view_31 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "nation_2_100_radb" AS F0),
_temp_view_30 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", (CASE  WHEN ((F0."n_name" = 'GERMANY') AND ((F0."ub_n_name" = F0."lb_n_name") AND ('GERMANY' = 'GERMANY'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."n_name" = 'GERMANY') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."n_nationkey" AS "n_nationkey", F0."n_name" AS "n_name", F0."n_regionkey" AS "n_regionkey", F0."n_comment" AS "n_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_regionkey" AS "ub_n_regionkey", F0."lb_n_regionkey" AS "lb_n_regionkey", F0."ub_n_comment" AS "ub_n_comment", F0."lb_n_comment" AS "lb_n_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_31) F0) F0
WHERE ((F0."lb_n_name" <= 'GERMANY') AND (F0."ub_n_name" >= 'GERMANY'))),
_temp_view_29 AS (
SELECT /*+ materialize */ F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_30) F0),
_temp_view_28 AS (
SELECT /*+ materialize */ F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_29) F0),
_temp_view_35 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_name" AS "ub_s_name", F0."lb_s_name" AS "lb_s_name", F0."ub_s_address" AS "ub_s_address", F0."lb_s_address" AS "lb_s_address", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_s_phone" AS "ub_s_phone", F0."lb_s_phone" AS "lb_s_phone", F0."ub_s_acctbal" AS "ub_s_acctbal", F0."lb_s_acctbal" AS "lb_s_acctbal", F0."ub_s_comment" AS "ub_s_comment", F0."lb_s_comment" AS "lb_s_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "supplier_2_100_radb" AS F0),
_temp_view_34 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."s_suppkey" AS "s_suppkey", F0."s_name" AS "s_name", F0."s_address" AS "s_address", F0."s_nationkey" AS "s_nationkey", F0."s_phone" AS "s_phone", F0."s_acctbal" AS "s_acctbal", F0."s_comment" AS "s_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_name" AS "ub_s_name", F0."lb_s_name" AS "lb_s_name", F0."ub_s_address" AS "ub_s_address", F0."lb_s_address" AS "lb_s_address", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_s_phone" AS "ub_s_phone", F0."lb_s_phone" AS "lb_s_phone", F0."ub_s_acctbal" AS "ub_s_acctbal", F0."lb_s_acctbal" AS "lb_s_acctbal", F0."ub_s_comment" AS "ub_s_comment", F0."lb_s_comment" AS "lb_s_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_35) F0),
_temp_view_33 AS (
SELECT /*+ materialize */ F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_34) F0),
_temp_view_32 AS (
SELECT /*+ materialize */ F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_33) F0),
_temp_view_39 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "lineitem_2_100_radb" AS F0),
_temp_view_38 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_39) F0),
_temp_view_37 AS (
SELECT /*+ materialize */ F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_38) F0),
_temp_view_36 AS (
SELECT /*+ materialize */ F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_37) F0),
_temp_view_43 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_2_100_radb" AS F0),
_temp_view_42 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_43) F0),
_temp_view_41 AS (
SELECT /*+ materialize */ F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_42) F0),
_temp_view_40 AS (
SELECT /*+ materialize */ F0."o_orderkey" AS "o_orderkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_41) F0),
_temp_view_27 AS (
SELECT /*+ materialize */ F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F0."l_orderkey" AS "l_orderkey", F0."l_suppkey" AS "l_suppkey", F1."o_orderkey" AS "o_orderkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."l_orderkey" = F1."o_orderkey") AND ((F0."ub_l_orderkey" = F0."lb_l_orderkey") AND (F1."ub_o_orderkey" = F1."lb_o_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."l_orderkey" = F1."o_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F0."s_suppkey" AS "s_suppkey", F0."s_nationkey" AS "s_nationkey", F1."l_orderkey" AS "l_orderkey", F1."l_suppkey" AS "l_suppkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F0."ub_s_suppkey" AS "ub_s_suppkey", F0."lb_s_suppkey" AS "lb_s_suppkey", F0."ub_s_nationkey" AS "ub_s_nationkey", F0."lb_s_nationkey" AS "lb_s_nationkey", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", F1."ub_l_suppkey" AS "ub_l_suppkey", F1."lb_l_suppkey" AS "lb_l_suppkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."s_suppkey" = F1."l_suppkey") AND ((F0."ub_s_suppkey" = F0."lb_s_suppkey") AND (F1."ub_l_suppkey" = F1."lb_l_suppkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."s_suppkey" = F1."l_suppkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n_name", F0."n_nationkey" AS "n_nationkey", F1."s_suppkey" AS "s_suppkey", F1."s_nationkey" AS "s_nationkey", F0."ub_n_name" AS "ub_n_name", F0."lb_n_name" AS "lb_n_name", F0."ub_n_nationkey" AS "ub_n_nationkey", F0."lb_n_nationkey" AS "lb_n_nationkey", F1."ub_s_suppkey" AS "ub_s_suppkey", F1."lb_s_suppkey" AS "lb_s_suppkey", F1."ub_s_nationkey" AS "ub_s_nationkey", F1."lb_s_nationkey" AS "lb_s_nationkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."n_nationkey" = F1."s_nationkey") AND ((F0."ub_n_nationkey" = F0."lb_n_nationkey") AND (F1."ub_s_nationkey" = F1."lb_s_nationkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."n_nationkey" = F1."s_nationkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT min(F0."n_name") AS "n_name", (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "n_nationkey", max(F0."ub_n_name") AS "ub_n_name", min(F0."lb_n_name") AS "lb_n_name", max(F0."ub_n_nationkey") AS "ub_n_nationkey", min(F0."lb_n_nationkey") AS "lb_n_nationkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_28) F0
GROUP BY (CASE  WHEN (F0."n_nationkey" >= 12) THEN 12 WHEN ((F0."n_nationkey" < 12) AND (F0."n_nationkey" >= 0)) THEN 0 ELSE 0 END)) F0 JOIN (
SELECT min(F0."s_suppkey") AS "s_suppkey", (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END) AS "s_nationkey", max(F0."ub_s_suppkey") AS "ub_s_suppkey", min(F0."lb_s_suppkey") AS "lb_s_suppkey", max(F0."ub_s_nationkey") AS "ub_s_nationkey", min(F0."lb_s_nationkey") AS "lb_s_nationkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_32) F0
GROUP BY (CASE  WHEN (F0."s_nationkey" >= 12) THEN 12 WHEN ((F0."s_nationkey" < 12) AND (F0."s_nationkey" >= 0)) THEN 0 ELSE 0 END)) F1 ON (((F0."lb_n_nationkey" <= F1."ub_s_nationkey") AND (F0."ub_n_nationkey" >= F1."lb_s_nationkey"))))) F0 JOIN (
SELECT min(F0."l_orderkey") AS "l_orderkey", (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END) AS "l_suppkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", max(F0."ub_l_suppkey") AS "ub_l_suppkey", min(F0."lb_l_suppkey") AS "lb_l_suppkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_36) F0
GROUP BY (CASE  WHEN (F0."l_suppkey" >= 500) THEN 500 WHEN ((F0."l_suppkey" < 500) AND (F0."l_suppkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_s_suppkey" <= F1."ub_l_suppkey") AND (F0."ub_s_suppkey" >= F1."lb_l_suppkey"))))) F0 JOIN (
SELECT (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "o_orderkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_40) F0
GROUP BY (CASE  WHEN (F0."o_orderkey" >= 300000) THEN 300000 WHEN ((F0."o_orderkey" < 300000) AND (F0."o_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_l_orderkey" <= F1."ub_o_orderkey") AND (F0."ub_l_orderkey" >= F1."lb_o_orderkey"))))),
_temp_view_15 AS (
SELECT /*+ materialize */ F0."n1" AS "n1", F0."o1" AS "o1", F1."n2" AS "n2", F1."o2" AS "o2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F0."ub_o1" AS "ub_o1", F0."lb_o1" AS "lb_o1", F1."ub_n2" AS "ub_n2", F1."lb_n2" AS "lb_n2", F1."ub_o2" AS "ub_o2", F1."lb_o2" AS "lb_o2", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o1" = F1."o2") AND ((F0."ub_o1" = F0."lb_o1") AND (F1."ub_o2" = F1."lb_o2"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o1" = F1."o2") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."n_name" AS "n1", F0."o_orderkey" AS "o1", F0."ub_n_name" AS "ub_n1", F0."lb_n_name" AS "lb_n1", F0."ub_o_orderkey" AS "ub_o1", F0."lb_o_orderkey" AS "lb_o1", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_16) F0) F0 JOIN (
SELECT F0."n_name" AS "n2", F0."o_orderkey" AS "o2", F0."ub_n_name" AS "ub_n2", F0."lb_n_name" AS "lb_n2", F0."ub_o_orderkey" AS "ub_o2", F0."lb_o_orderkey" AS "lb_o2", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_27) F0) F1 ON (((F0."lb_o1" <= F1."ub_o2") AND (F0."ub_o1" >= F1."lb_o2")))))
SELECT F0."n1" AS "n1", F0."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F0."ub_n2" AS "ub_n2", F0."lb_n2" AS "lb_n2", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_0) F0 UNION ALL
SELECT F0."n1" AS "n1", F0."n2" AS "n2", F0."ub_n1" AS "ub_n1", F0."lb_n1" AS "lb_n1", F0."ub_n2" AS "ub_n2", F0."lb_n2" AS "lb_n2", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_15) F0;
    #+end_src
- postgres plan
#+begin_example
                                                                                             QUERY PLAN
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Append  (cost=3541416197673.20..9439355079238.66 rows=157278501203071 width=216) (actual time=127015.150..215270.939 rows=8789 loops=1)
   CTE _temp_view_2
     ->  Seq Scan on customer_2_100_radb f0  (cost=0.00..11849.00 rows=150000 width=502) (actual time=28.612..2163.369 rows=150000 loops=1)
   CTE _temp_view_4
     ->  Seq Scan on nation_2_100_radb f0_1  (cost=0.00..13.00 rows=300 width=240) (actual time=12.893..12.914 rows=25 loops=1)
   CTE _temp_view_3
     ->  CTE Scan on _temp_view_4  (cost=0.00..7.75 rows=33 width=240) (actual time=12.908..12.952 rows=1 loops=1)
           Filter: ((lb_n_name <= 'IRAQ'::text) AND (ub_n_name >= 'IRAQ'::text))
           Rows Removed by Filter: 24
   CTE _temp_view_5
     ->  Seq Scan on orders_2_100_radb f0_2  (cost=0.00..86105.81 rows=1499981 width=339) (actual time=27.863..7176.856 rows=1500000 loops=1)
   CTE _temp_view_1
     ->  Hash Join  (cost=3625.26..794865.78 rows=6874918 width=1416) (actual time=2486.039..12750.780 rows=58195 loops=1)
           Hash Cond: (_temp_view_5.o_custkey = _temp_view_2.c_custkey)
           ->  CTE Scan on _temp_view_5  (cost=0.00..33749.57 rows=499994 width=644) (actual time=27.867..9044.384 rows=1500000 loops=1)
                 Filter: (bst_r > 0)
           ->  Hash  (cost=3590.88..3590.88 rows=2750 width=784) (actual time=2457.949..2457.950 rows=5893 loops=1)
                 Buckets: 8192 (originally 4096)  Batches: 2 (originally 1)  Memory Usage: 4033kB
                 ->  Hash Join  (cost=0.88..3590.88 rows=2750 width=784) (actual time=41.660..2441.233 rows=5893 loops=1)
                       Hash Cond: (_temp_view_2.c_nationkey = _temp_view_3.n_nationkey)
                       ->  CTE Scan on _temp_view_2  (cost=0.00..3375.00 rows=50000 width=548) (actual time=28.616..2397.932 rows=150000 loops=1)
                             Filter: (bst_r > 0)
                       ->  Hash  (cost=0.74..0.74 rows=11 width=236) (actual time=12.962..12.962 rows=1 loops=1)
                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                             ->  CTE Scan on _temp_view_3  (cost=0.00..0.74 rows=11 width=236) (actual time=12.912..12.957 rows=1 loops=1)
                                   Filter: (bst_r > 0)
   CTE _temp_view_8
     ->  Seq Scan on nation_2_100_radb f0_3  (cost=0.00..13.00 rows=300 width=240) (actual time=0.011..0.017 rows=25 loops=1)
   CTE _temp_view_7
     ->  CTE Scan on _temp_view_8  (cost=0.00..7.75 rows=33 width=240) (actual time=0.103..0.127 rows=1 loops=1)
           Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text))
           Rows Removed by Filter: 24
   CTE _temp_view_10
     ->  Seq Scan on supplier_2_100_radb f0_4  (cost=0.00..712.00 rows=10000 width=441) (actual time=137.736..501.918 rows=10000 loops=1)
   CTE _temp_view_9
     ->  CTE Scan on _temp_view_10  (cost=0.00..200.00 rows=10000 width=456) (actual time=137.769..517.871 rows=10000 loops=1)
   CTE _temp_view_12
     ->  Seq Scan on lineitem_2_100_radb f0_5  (cost=0.00..391766.09 rows=6000609 width=402) (actual time=611.263..78765.940 rows=6001215 loops=1)
   CTE _temp_view_11
     ->  CTE Scan on _temp_view_12  (cost=0.00..120012.18 rows=6000609 width=924) (actual time=611.299..91116.581 rows=6001215 loops=1)
   CTE _temp_view_14
     ->  Seq Scan on orders_2_100_radb f0_6  (cost=0.00..86105.81 rows=1499981 width=339) (actual time=0.053..594.746 rows=1500000 loops=1)
   CTE _temp_view_13
     ->  CTE Scan on _temp_view_14  (cost=0.00..29999.62 rows=1499981 width=648) (actual time=0.055..1926.960 rows=1500000 loops=1)
   CTE _temp_view_6
     ->  Merge Join  (cost=810557.93..252465188.53 rows=4575410094 width=180) (actual time=112257.958..113269.813 rows=224499 loops=1)
           Merge Cond: (_temp_view_13.o_orderkey = _temp_view_11.l_orderkey)
           ->  Sort  (cost=91332.88..92582.87 rows=499994 width=20) (actual time=4650.592..4996.096 rows=1499981 loops=1)
                 Sort Key: _temp_view_13.o_orderkey
                 Sort Method: external merge  Disk: 44048kB
                 ->  CTE Scan on _temp_view_13  (cost=0.00..33749.57 rows=499994 width=20) (actual time=0.058..3729.179 rows=1500000 loops=1)
                       Filter: (bst_r > 0)
           ->  Materialize  (cost=719225.04..728375.97 rows=1830186 width=180) (actual time=107607.247..107782.982 rows=232276 loops=1)
                 ->  Sort  (cost=719225.04..723800.51 rows=1830186 width=180) (actual time=107607.225..107729.891 rows=231075 loops=1)
                       Sort Key: _temp_view_11.l_orderkey
                       Sort Method: external merge  Disk: 26736kB
                       ->  Hash Join  (cost=242.50..203563.13 rows=1830186 width=180) (actual time=1156.155..107102.196 rows=231075 loops=1)
                             Hash Cond: (_temp_view_11.l_suppkey = _temp_view_9.s_suppkey)
                             ->  CTE Scan on _temp_view_11  (cost=0.00..135013.70 rows=2000203 width=32) (actual time=611.324..105303.805 rows=6001215 loops=1)
                                   Filter: (bst_r > 0)
                             ->  Hash  (cost=240.21..240.21 rows=183 width=148) (actual time=540.909..540.909 rows=384 loops=1)
                                   Buckets: 1024  Batches: 1  Memory Usage: 49kB
                                   ->  Hash Join  (cost=0.88..240.21 rows=183 width=148) (actual time=138.142..540.594 rows=384 loops=1)
                                         Hash Cond: (_temp_view_9.s_nationkey = _temp_view_7.n_nationkey)
                                         ->  CTE Scan on _temp_view_9  (cost=0.00..225.00 rows=3333 width=32) (actual time=137.789..538.418 rows=10000 loops=1)
                                               Filter: (bst_r > 0)
                                         ->  Hash  (cost=0.74..0.74 rows=11 width=116) (actual time=0.149..0.149 rows=1 loops=1)
                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                               ->  CTE Scan on _temp_view_7  (cost=0.00..0.74 rows=11 width=116) (actual time=0.120..0.144 rows=1 loops=1)
                                                     Filter: (bst_r > 0)
   CTE _temp_view_0
     ->  Merge Join  (cost=2235323389.63..3540998332709.46 rows=157277846063111 width=228) (actual time=127015.114..127146.261 rows=8757 loops=1)
           Merge Cond: (_temp_view_1.o_orderkey = _temp_view_6.o_orderkey)
           ->  Sort  (cost=2187159.87..2204347.16 rows=6874918 width=120) (actual time=13195.382..13207.240 rows=58195 loops=1)
                 Sort Key: _temp_view_1.o_orderkey
                 Sort Method: external merge  Disk: 3088kB
                 ->  CTE Scan on _temp_view_1  (cost=0.00..137498.36 rows=6874918 width=120) (actual time=2486.052..13121.032 rows=58195 loops=1)
           ->  Materialize  (cost=2233136229.77..2256013280.24 rows=4575410094 width=120) (actual time=113819.703..113894.002 rows=224516 loops=1)
                 ->  Sort  (cost=2233136229.77..2244574755.00 rows=4575410094 width=120) (actual time=113819.680..113860.248 rows=224499 loops=1)
                       Sort Key: _temp_view_6.o_orderkey
                       Sort Method: external sort  Disk: 12744kB
                       ->  CTE Scan on _temp_view_6  (cost=0.00..91508201.88 rows=4575410094 width=120) (actual time=112257.975..113585.989 rows=224499 loops=1)
   CTE _temp_view_19
     ->  Seq Scan on customer_2_100_radb f0_7  (cost=0.00..11849.00 rows=150000 width=502) (actual time=11.267..3382.199 rows=150000 loops=1)
   CTE _temp_view_18
     ->  CTE Scan on _temp_view_19  (cost=0.00..3000.00 rows=150000 width=552) (actual time=11.279..3609.335 rows=150000 loops=1)
   CTE _temp_view_17
     ->  CTE Scan on _temp_view_18  (cost=0.00..3000.00 rows=150000 width=552) (actual time=11.287..3851.160 rows=150000 loops=1)
   CTE _temp_view_23
     ->  Seq Scan on nation_2_100_radb f0_8  (cost=0.00..13.00 rows=300 width=240) (actual time=0.008..0.013 rows=25 loops=1)
   CTE _temp_view_22
     ->  CTE Scan on _temp_view_23  (cost=0.00..7.75 rows=33 width=240) (actual time=0.025..0.054 rows=1 loops=1)
           Filter: ((lb_n_name <= 'IRAQ'::text) AND (ub_n_name >= 'IRAQ'::text))
           Rows Removed by Filter: 24
   CTE _temp_view_21
     ->  CTE Scan on _temp_view_22  (cost=0.00..0.66 rows=33 width=240) (actual time=0.028..0.058 rows=1 loops=1)
   CTE _temp_view_20
     ->  CTE Scan on _temp_view_21  (cost=0.00..0.66 rows=33 width=240) (actual time=0.035..0.065 rows=1 loops=1)
   CTE _temp_view_26
     ->  Seq Scan on orders_2_100_radb f0_9  (cost=0.00..86105.81 rows=1499981 width=339) (actual time=0.040..643.206 rows=1500000 loops=1)
   CTE _temp_view_25
     ->  CTE Scan on _temp_view_26  (cost=0.00..29999.62 rows=1499981 width=648) (actual time=0.043..2797.099 rows=1500000 loops=1)
   CTE _temp_view_24
     ->  CTE Scan on _temp_view_25  (cost=0.00..29999.62 rows=1499981 width=648) (actual time=0.049..5479.016 rows=1500000 loops=1)
   CTE _temp_view_16
     ->  Nested Loop  (cost=180375.30..183801.80 rows=16289 width=1428) (actual time=21809.361..21809.387 rows=4 loops=1)
           Join Filter: (((min(_temp_view_17.lb_c_custkey)) <= (max(_temp_view_24.ub_o_custkey))) AND ((max(_temp_view_17.ub_c_custkey)) >= (min(_temp_view_24.lb_o_custkey))))
           ->  Nested Loop  (cost=15377.39..15499.38 rows=733 width=816) (actual time=4919.557..4919.571 rows=2 loops=1)
                 Join Filter: (((min(_temp_view_17.lb_c_nationkey)) <= (max(_temp_view_20.ub_n_nationkey))) AND ((max(_temp_view_17.ub_c_nationkey)) >= (min(_temp_view_20.lb_n_nationkey))))
                 ->  HashAggregate  (cost=15375.00..15378.50 rows=200 width=564) (actual time=4919.422..4919.429 rows=2 loops=1)
                       Group Key: CASE WHEN (_temp_view_17.c_nationkey >= 12) THEN 12 WHEN ((_temp_view_17.c_nationkey < 12) AND (_temp_view_17.c_nationkey >= 0)) THEN 0 ELSE 0 END
                       ->  CTE Scan on _temp_view_17  (cost=0.00..4125.00 rows=150000 width=552) (actual time=11.299..4289.395 rows=150000 loops=1)
                 ->  Materialize  (cost=2.39..3.47 rows=33 width=252) (actual time=0.063..0.064 rows=1 loops=2)
                       ->  HashAggregate  (cost=2.39..2.97 rows=33 width=252) (actual time=0.120..0.121 rows=1 loops=1)
                             Group Key: CASE WHEN (_temp_view_20.n_nationkey >= 12) THEN 12 WHEN ((_temp_view_20.n_nationkey < 12) AND (_temp_view_20.n_nationkey >= 0)) THEN 0 ELSE 0 END
                             ->  CTE Scan on _temp_view_20  (cost=0.00..0.91 rows=33 width=240) (actual time=0.047..0.077 rows=1 loops=1)
           ->  Materialize  (cost=164997.91..165004.41 rows=200 width=660) (actual time=8444.865..8444.868 rows=2 loops=2)
                 ->  HashAggregate  (cost=164997.91..165001.41 rows=200 width=660) (actual time=16889.726..16889.730 rows=2 loops=1)
                       Group Key: CASE WHEN (_temp_view_24.o_custkey >= 7500) THEN 7500 WHEN ((_temp_view_24.o_custkey < 7500) AND (_temp_view_24.o_custkey >= 1)) THEN 1 ELSE 1 END
                       ->  CTE Scan on _temp_view_24  (cost=0.00..41249.48 rows=1499981 width=648) (actual time=0.059..10147.205 rows=1500000 loops=1)
   CTE _temp_view_31
     ->  Seq Scan on nation_2_100_radb f0_10  (cost=0.00..13.00 rows=300 width=240) (actual time=0.013..0.018 rows=25 loops=1)
   CTE _temp_view_30
     ->  CTE Scan on _temp_view_31  (cost=0.00..7.75 rows=33 width=240) (actual time=0.079..0.090 rows=1 loops=1)
           Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text))
           Rows Removed by Filter: 24
   CTE _temp_view_29
     ->  CTE Scan on _temp_view_30  (cost=0.00..0.66 rows=33 width=120) (actual time=0.098..0.108 rows=1 loops=1)
   CTE _temp_view_28
     ->  CTE Scan on _temp_view_29  (cost=0.00..0.66 rows=33 width=120) (actual time=0.109..0.120 rows=1 loops=1)
   CTE _temp_view_35
     ->  Seq Scan on supplier_2_100_radb f0_11  (cost=0.00..712.00 rows=10000 width=441) (actual time=0.012..3.764 rows=10000 loops=1)
   CTE _temp_view_34
     ->  CTE Scan on _temp_view_35  (cost=0.00..200.00 rows=10000 width=456) (actual time=0.033..17.221 rows=10000 loops=1)
   CTE _temp_view_33
     ->  CTE Scan on _temp_view_34  (cost=0.00..200.00 rows=10000 width=36) (actual time=0.044..62.825 rows=10000 loops=1)
   CTE _temp_view_32
     ->  CTE Scan on _temp_view_33  (cost=0.00..200.00 rows=10000 width=36) (actual time=0.056..69.633 rows=10000 loops=1)
   CTE _temp_view_39
     ->  Seq Scan on lineitem_2_100_radb f0_12  (cost=0.00..391766.09 rows=6000609 width=402) (actual time=0.051..2754.453 rows=6001215 loops=1)
   CTE _temp_view_38
     ->  CTE Scan on _temp_view_39  (cost=0.00..120012.18 rows=6000609 width=924) (actual time=0.066..20473.954 rows=6001215 loops=1)
   CTE _temp_view_37
     ->  CTE Scan on _temp_view_38  (cost=0.00..120012.18 rows=6000609 width=36) (actual time=0.092..39545.969 rows=6001215 loops=1)
   CTE _temp_view_36
     ->  CTE Scan on _temp_view_37  (cost=0.00..120012.18 rows=6000609 width=36) (actual time=0.107..45657.972 rows=6001215 loops=1)
   CTE _temp_view_43
     ->  Seq Scan on orders_2_100_radb f0_13  (cost=0.00..86105.81 rows=1499981 width=339) (actual time=0.046..632.300 rows=1500000 loops=1)
   CTE _temp_view_42
     ->  CTE Scan on _temp_view_43  (cost=0.00..29999.62 rows=1499981 width=648) (actual time=0.054..3053.988 rows=1500000 loops=1)
   CTE _temp_view_41
     ->  CTE Scan on _temp_view_42  (cost=0.00..29999.62 rows=1499981 width=24) (actual time=0.072..7268.253 rows=1500000 loops=1)
   CTE _temp_view_40
     ->  CTE Scan on _temp_view_41  (cost=0.00..29999.62 rows=1499981 width=24) (actual time=0.084..8271.431 rows=1500000 loops=1)
   CTE _temp_view_27
     ->  Nested Loop  (cost=364281.29..446555.54 rows=361978 width=192) (actual time=66301.368..66301.416 rows=8 loops=1)
           Join Filter: (((min(_temp_view_32.lb_s_suppkey)) <= (max(_temp_view_36.ub_l_suppkey))) AND ((max(_temp_view_32.ub_s_suppkey)) >= (min(_temp_view_36.lb_l_suppkey))))
           ->  Nested Loop  (cost=363779.64..364491.14 rows=4444 width=84) (actual time=66217.353..66217.372 rows=4 loops=1)
                 Join Filter: (((min(_temp_view_36.lb_l_orderkey)) <= (max(_temp_view_40.ub_o_orderkey))) AND ((max(_temp_view_36.ub_l_orderkey)) >= (min(_temp_view_40.lb_o_orderkey))))
                 ->  HashAggregate  (cost=300030.45..300033.95 rows=200 width=48) (actual time=55915.487..55915.491 rows=2 loops=1)
                       Group Key: CASE WHEN (_temp_view_36.l_suppkey >= 500) THEN 500 WHEN ((_temp_view_36.l_suppkey < 500) AND (_temp_view_36.l_suppkey >= 1)) THEN 1 ELSE 1 END
                       ->  CTE Scan on _temp_view_36  (cost=0.00..165016.75 rows=6000609 width=36) (actual time=0.135..51463.001 rows=6001215 loops=1)
                 ->  Materialize  (cost=63749.19..63755.69 rows=200 width=36) (actual time=5150.905..5150.910 rows=2 loops=2)
                       ->  HashAggregate  (cost=63749.19..63752.69 rows=200 width=36) (actual time=10301.804..10301.813 rows=2 loops=1)
                             Group Key: CASE WHEN (_temp_view_40.o_orderkey >= 300000) THEN 300000 WHEN ((_temp_view_40.o_orderkey < 300000) AND (_temp_view_40.o_orderkey >= 1)) THEN 1 ELSE 1 END
                             ->  CTE Scan on _temp_view_40  (cost=0.00..41249.48 rows=1499981 width=24) (actual time=0.099..9457.517 rows=1500000 loops=1)
           ->  Materialize  (cost=501.65..627.30 rows=733 width=180) (actual time=20.983..20.986 rows=2 loops=4)
                 ->  Nested Loop  (cost=501.65..623.64 rows=733 width=180) (actual time=83.922..83.930 rows=2 loops=1)
                       Join Filter: (((min(_temp_view_28.lb_n_nationkey)) <= (max(_temp_view_32.ub_s_nationkey))) AND ((max(_temp_view_28.ub_n_nationkey)) >= (min(_temp_view_32.lb_s_nationkey))))
                       ->  HashAggregate  (cost=500.00..503.50 rows=200 width=48) (actual time=83.670..83.674 rows=2 loops=1)
                             Group Key: CASE WHEN (_temp_view_32.s_nationkey >= 12) THEN 12 WHEN ((_temp_view_32.s_nationkey < 12) AND (_temp_view_32.s_nationkey >= 0)) THEN 0 ELSE 0 END
                             ->  CTE Scan on _temp_view_32  (cost=0.00..275.00 rows=10000 width=36) (actual time=0.082..76.803 rows=10000 loops=1)
                       ->  Materialize  (cost=1.65..2.72 rows=33 width=132) (actual time=0.106..0.106 rows=1 loops=2)
                             ->  HashAggregate  (cost=1.65..2.23 rows=33 width=132) (actual time=0.207..0.208 rows=1 loops=1)
                                   Group Key: CASE WHEN (_temp_view_28.n_nationkey >= 12) THEN 12 WHEN ((_temp_view_28.n_nationkey < 12) AND (_temp_view_28.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                   ->  CTE Scan on _temp_view_28  (cost=0.00..0.91 rows=33 width=120) (actual time=0.125..0.136 rows=1 loops=1)
   CTE _temp_view_15
     ->  Nested Loop  (cost=0.00..162154542.60 rows=655139960 width=240) (actual time=88110.792..88110.964 rows=32 loops=1)
           Join Filter: ((_temp_view_16.lb_o_orderkey <= _temp_view_27.ub_o_orderkey) AND (_temp_view_16.ub_o_orderkey >= _temp_view_27.lb_o_orderkey))
           ->  CTE Scan on _temp_view_27  (cost=0.00..7239.56 rows=361978 width=132) (actual time=66301.379..66301.438 rows=8 loops=1)
           ->  CTE Scan on _temp_view_16  (cost=0.00..325.78 rows=16289 width=132) (actual time=2726.173..2726.181 rows=4 loops=8)
   ->  Subquery Scan on "*SELECT* 1"  (cost=0.00..5897919227366.66 rows=157277846063111 width=216) (actual time=127015.148..127158.595 rows=8757 loops=1)
         ->  CTE Scan on _temp_view_0  (cost=0.00..3145556921262.22 rows=157277846063111 width=204) (actual time=127015.138..127156.150 rows=8757 loops=1)
   ->  CTE Scan on _temp_view_15  (cost=0.00..13102799.20 rows=655139960 width=216) (actual time=88110.805..88111.019 rows=32 loops=1)
 Planning time: 8.951 ms
 Execution time: 217991.028 ms
#+end_example
* PDBench on my machine
** Q1
*** Non-optimized
    #+begin_src

    #+end_src
*** Optimized with GProM
    #+begin_src sql

    #+end_src

** Q2
*** Non-optimized
    #+begin_src

    #+end_src
*** Optimized with GProM
    #+begin_src sql

    #+end_src
** Q3
*** Non-optimized
    #+begin_src sql
WITH _temp_view_3 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "customer_radb" AS F0),
_temp_view_2 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", (CASE  WHEN ((F0."c_mktsegment" = 'BUILDING') AND ((F0."ub_c_mktsegment" = F0."lb_c_mktsegment") AND ('BUILDING' = 'BUILDING'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."c_mktsegment" = 'BUILDING') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_3) F0) F0
WHERE ((F0."lb_c_mktsegment" <= 'BUILDING') AND (F0."ub_c_mktsegment" >= 'BUILDING'))),
_temp_view_5 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_radb" AS F0),
_temp_view_4 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", (CASE  WHEN (F0."lb_o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_5) F0) F0
WHERE (F0."ub_o_orderdate" > '1995-03-15')),
_temp_view_1 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F1."o_custkey" AS "o_custkey", F1."o_orderkey" AS "o_orderkey", F1."o_orderdate" AS "o_orderdate", F1."o_shippriority" AS "o_shippriority", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F1."ub_o_custkey" AS "ub_o_custkey", F1."lb_o_custkey" AS "lb_o_custkey", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."c_custkey" AS "ub_c_custkey", F0."c_custkey" AS "lb_c_custkey", (CASE  WHEN (F0."ub_c_custkey" = F0."lb_c_custkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_2) F0) F0
WHERE (F0."bst_r" > 0)) F0 JOIN (
SELECT F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."o_custkey" AS "ub_o_custkey", F0."o_custkey" AS "lb_o_custkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", (CASE  WHEN ((((F0."ub_o_custkey" = F0."lb_o_custkey") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_4) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."c_custkey" = F1."o_custkey")))),
_temp_view_7 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "lineitem_radb" AS F0),
_temp_view_6 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", (CASE  WHEN (F0."ub_l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_7) F0) F0
WHERE (F0."lb_l_shipdate" < '1995-03-17')),
_temp_view_0 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F1."l_orderkey" AS "l_orderkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_1) F0) F0 JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_orderkey" AS "ub_l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", (CASE  WHEN (F0."ub_l_orderkey" = F0."lb_l_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_6) F0) F0
WHERE (F0."bst_r" > 0)) F1 ON ((F0."o_orderkey" = F1."l_orderkey")))),
_temp_view_13 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "customer_radb" AS F0),
_temp_view_12 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", (CASE  WHEN ((F0."c_mktsegment" = 'BUILDING') AND ((F0."ub_c_mktsegment" = F0."lb_c_mktsegment") AND ('BUILDING' = 'BUILDING'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."c_mktsegment" = 'BUILDING') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."c_custkey" AS "c_custkey", F0."c_name" AS "c_name", F0."c_address" AS "c_address", F0."c_nationkey" AS "c_nationkey", F0."c_phone" AS "c_phone", F0."c_acctbal" AS "c_acctbal", F0."c_mktsegment" AS "c_mktsegment", F0."c_comment" AS "c_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_name" AS "ub_c_name", F0."lb_c_name" AS "lb_c_name", F0."ub_c_address" AS "ub_c_address", F0."lb_c_address" AS "lb_c_address", F0."ub_c_nationkey" AS "ub_c_nationkey", F0."lb_c_nationkey" AS "lb_c_nationkey", F0."ub_c_phone" AS "ub_c_phone", F0."lb_c_phone" AS "lb_c_phone", F0."ub_c_acctbal" AS "ub_c_acctbal", F0."lb_c_acctbal" AS "lb_c_acctbal", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment", F0."ub_c_comment" AS "ub_c_comment", F0."lb_c_comment" AS "lb_c_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_13) F0) F0
WHERE ((F0."lb_c_mktsegment" <= 'BUILDING') AND (F0."ub_c_mktsegment" >= 'BUILDING'))),
_temp_view_11 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_12) F0),
_temp_view_10 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_11) F0),
_temp_view_17 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "orders_radb" AS F0),
_temp_view_16 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", (CASE  WHEN (F0."lb_o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderstatus" AS "o_orderstatus", F0."o_totalprice" AS "o_totalprice", F0."o_orderdate" AS "o_orderdate", F0."o_orderpriority" AS "o_orderpriority", F0."o_clerk" AS "o_clerk", F0."o_shippriority" AS "o_shippriority", F0."o_comment" AS "o_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderstatus" AS "ub_o_orderstatus", F0."lb_o_orderstatus" AS "lb_o_orderstatus", F0."ub_o_totalprice" AS "ub_o_totalprice", F0."lb_o_totalprice" AS "lb_o_totalprice", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_orderpriority" AS "ub_o_orderpriority", F0."lb_o_orderpriority" AS "lb_o_orderpriority", F0."ub_o_clerk" AS "ub_o_clerk", F0."lb_o_clerk" AS "lb_o_clerk", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."ub_o_comment" AS "ub_o_comment", F0."lb_o_comment" AS "lb_o_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_17) F0) F0
WHERE (F0."ub_o_orderdate" > '1995-03-15')),
_temp_view_15 AS (
SELECT /*+ materialize */ F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_16) F0),
_temp_view_14 AS (
SELECT /*+ materialize */ F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_15) F0),
_temp_view_9 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F1."o_custkey" AS "o_custkey", F1."o_orderkey" AS "o_orderkey", F1."o_orderdate" AS "o_orderdate", F1."o_shippriority" AS "o_shippriority", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F1."ub_o_custkey" AS "ub_o_custkey", F1."lb_o_custkey" AS "lb_o_custkey", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT (CASE  WHEN (F0."c_custkey" >= 7500) THEN 7500 WHEN ((F0."c_custkey" < 7500) AND (F0."c_custkey" >= 1)) THEN 1 ELSE 1 END) AS "c_custkey", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_10) F0
GROUP BY (CASE  WHEN (F0."c_custkey" >= 7500) THEN 7500 WHEN ((F0."c_custkey" < 7500) AND (F0."c_custkey" >= 1)) THEN 1 ELSE 1 END)) F0 JOIN (
SELECT (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderkey") AS "o_orderkey", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_shippriority") AS "o_shippriority", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_14) F0
GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))),
_temp_view_21 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM "lineitem_radb" AS F0),
_temp_view_20 AS (
SELECT /*+ materialize */ F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", (CASE  WHEN (F0."ub_l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."tid" AS "tid", F0."l_orderkey" AS "l_orderkey", F0."l_partkey" AS "l_partkey", F0."l_suppkey" AS "l_suppkey", F0."l_linenumber" AS "l_linenumber", F0."l_quantity" AS "l_quantity", F0."l_extendedprice" AS "l_extendedprice", F0."l_discount" AS "l_discount", F0."l_tax" AS "l_tax", F0."l_returnflag" AS "l_returnflag", F0."l_linestatus" AS "l_linestatus", F0."l_shipdate" AS "l_shipdate", F0."l_commitdate" AS "l_commitdate", F0."l_receiptdate" AS "l_receiptdate", F0."l_shipinstruct" AS "l_shipinstruct", F0."l_shipmode" AS "l_shipmode", F0."l_comment" AS "l_comment", F0."ub_tid" AS "ub_tid", F0."lb_tid" AS "lb_tid", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_partkey" AS "ub_l_partkey", F0."lb_l_partkey" AS "lb_l_partkey", F0."ub_l_suppkey" AS "ub_l_suppkey", F0."lb_l_suppkey" AS "lb_l_suppkey", F0."ub_l_linenumber" AS "ub_l_linenumber", F0."lb_l_linenumber" AS "lb_l_linenumber", F0."ub_l_quantity" AS "ub_l_quantity", F0."lb_l_quantity" AS "lb_l_quantity", F0."ub_l_extendedprice" AS "ub_l_extendedprice", F0."lb_l_extendedprice" AS "lb_l_extendedprice", F0."ub_l_discount" AS "ub_l_discount", F0."lb_l_discount" AS "lb_l_discount", F0."ub_l_tax" AS "ub_l_tax", F0."lb_l_tax" AS "lb_l_tax", F0."ub_l_returnflag" AS "ub_l_returnflag", F0."lb_l_returnflag" AS "lb_l_returnflag", F0."ub_l_linestatus" AS "ub_l_linestatus", F0."lb_l_linestatus" AS "lb_l_linestatus", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate", F0."ub_l_commitdate" AS "ub_l_commitdate", F0."lb_l_commitdate" AS "lb_l_commitdate", F0."ub_l_receiptdate" AS "ub_l_receiptdate", F0."lb_l_receiptdate" AS "lb_l_receiptdate", F0."ub_l_shipinstruct" AS "ub_l_shipinstruct", F0."lb_l_shipinstruct" AS "lb_l_shipinstruct", F0."ub_l_shipmode" AS "ub_l_shipmode", F0."lb_l_shipmode" AS "lb_l_shipmode", F0."ub_l_comment" AS "ub_l_comment", F0."lb_l_comment" AS "lb_l_comment", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_21) F0) F0
WHERE (F0."lb_l_shipdate" < '1995-03-17')),
_temp_view_19 AS (
SELECT /*+ materialize */ F0."l_orderkey" AS "l_orderkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_20) F0),
_temp_view_18 AS (
SELECT /*+ materialize */ F0."l_orderkey" AS "l_orderkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", 0 AS "cet_r", 0 AS "bst_r", F0."bst_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_19) F0),
_temp_view_8 AS (
SELECT /*+ materialize */ F0."c_custkey" AS "c_custkey", F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F1."l_orderkey" AS "l_orderkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F1."ub_l_orderkey" AS "ub_l_orderkey", F1."lb_l_orderkey" AS "lb_l_orderkey", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o_orderkey" = F1."l_orderkey") AND ((F0."ub_o_orderkey" = F0."lb_o_orderkey") AND (F1."ub_l_orderkey" = F1."lb_l_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o_orderkey" = F1."l_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_9) F0) F0 JOIN (
SELECT (CASE  WHEN (F0."l_orderkey" >= 300000) THEN 300000 WHEN ((F0."l_orderkey" < 300000) AND (F0."l_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "l_orderkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", sum(F0."cet_r") AS "cet_r", sum(F0."bst_r") AS "bst_r", sum(F0."pos_r") AS "pos_r"
FROM (SELECT * FROM _temp_view_18) F0
GROUP BY (CASE  WHEN (F0."l_orderkey" >= 300000) THEN 300000 WHEN ((F0."l_orderkey" < 300000) AND (F0."l_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_o_orderkey" <= F1."ub_l_orderkey") AND (F0."ub_o_orderkey" >= F1."lb_l_orderkey")))))
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_0) F0 UNION ALL
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (SELECT * FROM _temp_view_8) F0;
    #+end_src
- postgres plan local SF 0.1
#+begin_example
                                                                                                  QUERY PLAN
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Append  (cost=10506.73..15980857513.87 rows=73470712710 width=228) (actual time=92.337..1582.160 rows=1431 loops=1)
   ->  Subquery Scan on "*SELECT* 1"  (cost=10506.73..48507.41 rows=1898 width=75) (actual time=92.336..392.942 rows=1423 loops=1)
         ->  Gather  (cost=10506.73..48474.19 rows=1898 width=63) (actual time=92.334..392.934 rows=1423 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=9506.73..47284.39 rows=791 width=63) (actual time=88.925..388.457 rows=474 loops=3)
                     Hash Cond: (f0_2.l_orderkey = f0_1.o_orderkey)
                     ->  Parallel Seq Scan on lineitem_radb f0_2  (cost=0.00..37582.94 rows=39445 width=34) (actual time=0.073..283.632 rows=90568 loops=3)
                           Filter: ((lb_l_shipdate < '1995-03-17'::text) AND (CASE WHEN (l_shipdate < '1995-03-17'::text) THEN 1 ELSE 0 END > 0))
                           Rows Removed by Filter: 109623
                     ->  Parallel Hash  (cost=9491.26..9491.26 rows=1238 width=95) (actual time=87.886..87.886 rows=5313 loops=3)
                           Buckets: 16384 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 2400kB
                           ->  Parallel Hash Join  (cost=1225.77..9491.26 rows=1238 width=95) (actual time=7.525..81.675 rows=5313 loops=3)
                                 Hash Cond: (f0_1.o_custkey = f0.c_custkey)
                                 ->  Parallel Seq Scan on orders_radb f0_1  (cost=0.00..8203.75 rows=10891 width=63) (actual time=0.020..69.670 rows=26163 loops=3)
                                       Filter: ((ub_o_orderdate > '1995-03-15'::text) AND (CASE WHEN (o_orderdate > '1995-03-15'::text) THEN 1 ELSE 0 END > 0))
                                       Rows Removed by Filter: 23837
                                 ->  Parallel Hash  (cost=1213.47..1213.47 rows=984 width=40) (actual time=7.444..7.444 rows=1019 loops=3)
                                       Buckets: 4096 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 336kB
                                       ->  Parallel Seq Scan on customer_radb f0  (cost=0.00..1213.47 rows=984 width=40) (actual time=0.031..5.860 rows=1019 loops=3)
                                             Filter: ((lb_c_mktsegment <= 'BUILDING'::text) AND (ub_c_mktsegment >= 'BUILDING'::text) AND (CASE WHEN (c_mktsegment = 'BUILDING'::text) THEN 1 ELSE 0 END > 0))
                                             Rows Removed by Filter: 3981
   ->  Nested Loop  (cost=61907.97..14878748334.79 rows=73470710812 width=228) (actual time=1188.513..1189.056 rows=8 loops=1)
         Join Filter: (((min(f0_4.lb_o_orderkey)) <= f1.ub_l_orderkey) AND ((max(f0_4.ub_o_orderkey)) >= f1.lb_l_orderkey))
         ->  Nested Loop  (cost=14097.12..877966.12 rows=5482207 width=276) (actual time=348.883..348.924 rows=4 loops=1)
               Join Filter: ((f0_3.lb_c_custkey <= (max(f0_4.ub_o_custkey))) AND (f0_3.ub_c_custkey >= (min(f0_4.lb_o_custkey))))
               ->  HashAggregate  (cost=12709.62..12882.27 rows=9866 width=240) (actual time=337.331..337.358 rows=2 loops=1)
                     Group Key: CASE WHEN (f0_4.o_custkey >= 7500) THEN 7500 WHEN ((f0_4.o_custkey < 7500) AND (f0_4.o_custkey >= 1)) THEN 1 ELSE 1 END
                     ->  Seq Scan on orders_radb f0_4  (cost=0.00..9573.10 rows=78413 width=63) (actual time=0.036..125.180 rows=78490 loops=1)
                           Filter: (ub_o_orderdate > '1995-03-15'::text)
                           Rows Removed by Filter: 71510
               ->  Materialize  (cost=1387.50..1550.03 rows=5001 width=36) (actual time=5.774..5.780 rows=2 loops=2)
                     ->  Subquery Scan on f0_3  (cost=1387.50..1525.03 rows=5001 width=36) (actual time=11.545..11.556 rows=2 loops=1)
                           ->  HashAggregate  (cost=1387.50..1475.02 rows=5001 width=36) (actual time=11.544..11.554 rows=2 loops=1)
                                 Group Key: CASE WHEN (f0_5.c_custkey >= 7500) THEN 7500 WHEN ((f0_5.c_custkey < 7500) AND (f0_5.c_custkey >= 1)) THEN 1 ELSE 1 END
                                 ->  Seq Scan on customer_radb f0_5  (cost=0.00..1299.65 rows=5020 width=21) (actual time=0.012..10.969 rows=3297 loops=1)
                                       Filter: ((lb_c_mktsegment <= 'BUILDING'::text) AND (ub_c_mktsegment >= 'BUILDING'::text))
                                       Rows Removed by Filter: 11703
         ->  Materialize  (cost=47810.85..51730.84 rows=120615 width=36) (actual time=209.906..210.030 rows=2 loops=4)
               ->  Subquery Scan on f1  (cost=47810.85..51127.76 rows=120615 width=36) (actual time=839.620..840.115 rows=2 loops=1)
                     ->  HashAggregate  (cost=47810.85..49921.61 rows=120615 width=36) (actual time=839.620..840.114 rows=2 loops=1)
                           Group Key: CASE WHEN (f0_6.l_orderkey >= 300000) THEN 300000 WHEN ((f0_6.l_orderkey < 300000) AND (f0_6.l_orderkey >= 1)) THEN 1 ELSE 1 END
                           ->  Seq Scan on lineitem_radb f0_6  (cost=0.00..42840.78 rows=284004 width=23) (actual time=0.024..609.536 rows=282108 loops=1)
                                 Filter: (lb_l_shipdate < '1995-03-17'::text)
                                 Rows Removed by Filter: 318464
 Planning Time: 10.867 ms
 Execution Time: 1586.199 ms
#+end_example
*** Optimized by GProM
    #+begin_src sql
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F1."o_orderkey" AS "o_orderkey", F1."o_orderdate" AS "o_orderdate", F1."o_shippriority" AS "o_shippriority", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", (F0."cet_r" * F1."cet_r") AS "cet_r", (F0."bst_r" * F1."bst_r") AS "bst_r", (F0."pos_r" * F1."pos_r") AS "pos_r"
FROM ((
SELECT F0."c_custkey" AS "c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_custkey" AS "lb_c_custkey", (CASE  WHEN (F0."ub_c_custkey" = F0."lb_c_custkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", (CASE  WHEN ((F0."c_mktsegment" = 'BUILDING') AND ((F0."ub_c_mktsegment" = F0."lb_c_mktsegment") AND ('BUILDING' = 'BUILDING'))) THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."c_mktsegment" = 'BUILDING') THEN 1 ELSE 0 END) AS "bst_r"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_mktsegment" AS "c_mktsegment", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment"
FROM "customer_radb" AS F0) F0
WHERE ((F0."lb_c_mktsegment" <= 'BUILDING') AND (F0."ub_c_mktsegment" >= 'BUILDING'))) F0
WHERE (F0."bst_r" > 0)) F0
WHERE (F0."c_custkey" = F0."lb_c_custkey")) F0 JOIN (
SELECT F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."o_custkey" AS "lb_o_custkey", F0."o_orderkey" AS "ub_o_orderkey", F0."o_orderkey" AS "lb_o_orderkey", F0."o_orderdate" AS "ub_o_orderdate", F0."o_orderdate" AS "lb_o_orderdate", F0."o_shippriority" AS "ub_o_shippriority", F0."o_shippriority" AS "lb_o_shippriority", (CASE  WHEN ((((F0."ub_o_custkey" = F0."lb_o_custkey") AND (F0."ub_o_orderkey" = F0."lb_o_orderkey")) AND (F0."ub_o_orderdate" = F0."lb_o_orderdate")) AND (F0."ub_o_shippriority" = F0."lb_o_shippriority")) THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."o_custkey" AS "o_custkey", F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", (CASE  WHEN (F0."lb_o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END) AS "bst_r"
FROM (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority"
FROM "orders_radb" AS F0) F0
WHERE (F0."ub_o_orderdate" > '1995-03-15')) F0
WHERE (F0."bst_r" > 0)) F0
WHERE ((((F0."o_orderkey" = F0."lb_o_orderkey") AND (F0."o_custkey" = F0."lb_o_custkey")) AND (F0."o_orderdate" = F0."lb_o_orderdate")) AND (F0."o_shippriority" = F0."lb_o_shippriority"))) F1 ON ((F0."c_custkey" = F1."o_custkey")))) F0 JOIN (
SELECT F0."l_orderkey" AS "l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."cet_r" AS "cet_r", F0."bst_r" AS "bst_r", F0."pos_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_orderkey" AS "lb_l_orderkey", (CASE  WHEN (F0."ub_l_orderkey" = F0."lb_l_orderkey") THEN F0."cet_r" ELSE 0 END) AS "cet_r", F0."bst_r" AS "bst_r", F0."bst_r" AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", (CASE  WHEN (F0."ub_l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "cet_r", (CASE  WHEN (F0."l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END) AS "bst_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_shipdate" AS "l_shipdate", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."ub_l_shipdate" AS "ub_l_shipdate", F0."lb_l_shipdate" AS "lb_l_shipdate"
FROM "lineitem_radb" AS F0) F0
WHERE (F0."lb_l_shipdate" < '1995-03-17')) F0
WHERE (F0."bst_r" > 0)) F0
WHERE (F0."l_orderkey" = F0."lb_l_orderkey")) F1 ON ((F0."o_orderkey" = F1."l_orderkey"))) UNION ALL
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."o_orderkey" = F1."l_orderkey") AND ((F0."ub_o_orderkey" = F0."lb_o_orderkey") AND (F1."ub_l_orderkey" = F1."lb_l_orderkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."o_orderkey" = F1."l_orderkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT F1."o_orderkey" AS "o_orderkey", F1."o_orderdate" AS "o_orderdate", F1."o_shippriority" AS "o_shippriority", F1."ub_o_orderkey" AS "ub_o_orderkey", F1."lb_o_orderkey" AS "lb_o_orderkey", F1."ub_o_orderdate" AS "ub_o_orderdate", F1."lb_o_orderdate" AS "lb_o_orderdate", F1."ub_o_shippriority" AS "ub_o_shippriority", F1."lb_o_shippriority" AS "lb_o_shippriority", ((F0."cet_r" + F1."cet_r") + (CASE  WHEN ((F0."c_custkey" = F1."o_custkey") AND ((F0."ub_c_custkey" = F0."lb_c_custkey") AND (F1."ub_o_custkey" = F1."lb_o_custkey"))) THEN 1 ELSE 0 END)) AS "cet_r", ((F0."bst_r" + F1."bst_r") + (CASE  WHEN (F0."c_custkey" = F1."o_custkey") THEN 1 ELSE 0 END)) AS "bst_r", (F0."pos_r" + F1."pos_r") AS "pos_r"
FROM ((
SELECT (CASE  WHEN (F0."c_custkey" >= 7500) THEN 7500 WHEN ((F0."c_custkey" < 7500) AND (F0."c_custkey" >= 1)) THEN 1 ELSE 1 END) AS "c_custkey", max(F0."ub_c_custkey") AS "ub_c_custkey", min(F0."lb_c_custkey") AS "lb_c_custkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."c_mktsegment" = 'BUILDING') THEN 1 ELSE 0 END)) AS "pos_r"
FROM (
SELECT F0."c_custkey" AS "c_custkey", F0."c_mktsegment" AS "c_mktsegment", F0."ub_c_custkey" AS "ub_c_custkey", F0."lb_c_custkey" AS "lb_c_custkey", F0."ub_c_mktsegment" AS "ub_c_mktsegment", F0."lb_c_mktsegment" AS "lb_c_mktsegment"
FROM "customer_radb" AS F0) F0
WHERE ((F0."lb_c_mktsegment" <= 'BUILDING') AND (F0."ub_c_mktsegment" >= 'BUILDING'))
GROUP BY (CASE  WHEN (F0."c_custkey" >= 7500) THEN 7500 WHEN ((F0."c_custkey" < 7500) AND (F0."c_custkey" >= 1)) THEN 1 ELSE 1 END)) F0 JOIN (
SELECT (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END) AS "o_custkey", min(F0."o_orderkey") AS "o_orderkey", min(F0."o_orderdate") AS "o_orderdate", min(F0."o_shippriority") AS "o_shippriority", max(F0."ub_o_custkey") AS "ub_o_custkey", min(F0."lb_o_custkey") AS "lb_o_custkey", max(F0."ub_o_orderkey") AS "ub_o_orderkey", min(F0."lb_o_orderkey") AS "lb_o_orderkey", max(F0."ub_o_orderdate") AS "ub_o_orderdate", min(F0."lb_o_orderdate") AS "lb_o_orderdate", max(F0."ub_o_shippriority") AS "ub_o_shippriority", min(F0."lb_o_shippriority") AS "lb_o_shippriority", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."o_orderdate" > '1995-03-15') THEN 1 ELSE 0 END)) AS "pos_r"
FROM (
SELECT F0."o_orderkey" AS "o_orderkey", F0."o_custkey" AS "o_custkey", F0."o_orderdate" AS "o_orderdate", F0."o_shippriority" AS "o_shippriority", F0."ub_o_orderkey" AS "ub_o_orderkey", F0."lb_o_orderkey" AS "lb_o_orderkey", F0."ub_o_custkey" AS "ub_o_custkey", F0."lb_o_custkey" AS "lb_o_custkey", F0."ub_o_orderdate" AS "ub_o_orderdate", F0."lb_o_orderdate" AS "lb_o_orderdate", F0."ub_o_shippriority" AS "ub_o_shippriority", F0."lb_o_shippriority" AS "lb_o_shippriority"
FROM "orders_radb" AS F0) F0
WHERE (F0."ub_o_orderdate" > '1995-03-15')
GROUP BY (CASE  WHEN (F0."o_custkey" >= 7500) THEN 7500 WHEN ((F0."o_custkey" < 7500) AND (F0."o_custkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_c_custkey" <= F1."ub_o_custkey") AND (F0."ub_c_custkey" >= F1."lb_o_custkey"))))) F0 JOIN (
SELECT (CASE  WHEN (F0."l_orderkey" >= 300000) THEN 300000 WHEN ((F0."l_orderkey" < 300000) AND (F0."l_orderkey" >= 1)) THEN 1 ELSE 1 END) AS "l_orderkey", max(F0."ub_l_orderkey") AS "ub_l_orderkey", min(F0."lb_l_orderkey") AS "lb_l_orderkey", sum(0) AS "cet_r", sum(0) AS "bst_r", sum((CASE  WHEN (F0."l_shipdate" < '1995-03-17') THEN 1 ELSE 0 END)) AS "pos_r"
FROM (
SELECT F0."l_orderkey" AS "l_orderkey", F0."l_shipdate" AS "l_shipdate", F0."ub_l_orderkey" AS "ub_l_orderkey", F0."lb_l_orderkey" AS "lb_l_orderkey", F0."lb_l_shipdate" AS "lb_l_shipdate"
FROM "lineitem_radb" AS F0) F0
WHERE (F0."lb_l_shipdate" < '1995-03-17')
GROUP BY (CASE  WHEN (F0."l_orderkey" >= 300000) THEN 300000 WHEN ((F0."l_orderkey" < 300000) AND (F0."l_orderkey" >= 1)) THEN 1 ELSE 1 END)) F1 ON (((F0."lb_o_orderkey" <= F1."ub_l_orderkey") AND (F0."ub_o_orderkey" >= F1."lb_l_orderkey"))));
    #+end_src
- local postgres 0.1 SF plan
#+begin_example

                                                                                                                                                                                       QUERY PLAN
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   Append  (cost=47893.23..542413787030.60 rows=1762724672407 width=216) (actual time=188.439..536.711 rows=1227 loops=1)
     ->  Subquery Scan on "*SELECT* 1"  (cost=47893.23..56357.62 rows=1897 width=216) (actual time=188.438..215.165 rows=1203 loops=1)
           ->  Gather  (cost=47893.23..56324.42 rows=1897 width=204) (actual time=188.437..218.295 rows=1203 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Parallel Hash Join  (cost=46893.23..55134.72 rows=790 width=204) (actual time=180.293..206.400 rows=401 loops=3)
                       Hash Cond: (f0_6.o_orderkey = f0_5.l_orderkey)
                       ->  Parallel Seq Scan on orders_radb f0_6  (cost=0.00..7891.25 rows=62500 width=20) (actual time=0.010..20.691 rows=50000 loops=3)
                             Filter: ((o_orderkey IS NOT NULL) AND (bst_r > 0))
                       ->  Parallel Hash  (cost=46883.47..46883.47 rows=781 width=905) (actual time=179.261..179.261 rows=395 loops=3)
                             Buckets: 2048  Batches: 1  Memory Usage: 1136kB
                             ->  Hash Join  (cost=9493.08..46883.47 rows=781 width=905) (actual time=47.178..178.302 rows=395 loops=3)
                                   Hash Cond: (f0_5.l_suppkey = f0_4.s_suppkey)
                                   ->  Parallel Hash Join  (cost=9397.46..46726.79 rows=14200 width=781) (actual time=45.946..176.207 rows=7975 loops=3)
                                         Hash Cond: (f0_5.l_orderkey = f0_2.o_orderkey)
                                         ->  Parallel Seq Scan on lineitem_radb f0_5  (cost=0.00..36331.81 rows=250225 width=32) (actual time=0.092..101.617 rows=200191 loops=3)
                                               Filter: ((l_orderkey IS NOT NULL) AND (l_suppkey IS NOT NULL) AND (bst_r > 0))
                                         ->  Parallel Hash  (cost=9353.66..9353.66 rows=3504 width=749) (actual time=45.767..45.767 rows=2031 loops=3)
                                               Buckets: 16384  Batches: 1  Memory Usage: 5216kB
                                               ->  Parallel Hash Join  (cost=1207.43..9353.66 rows=3504 width=749) (actual time=4.623..42.443 rows=2031 loops=3)
                                                     Hash Cond: (f0_2.o_custkey = f0.c_custkey)
                                                     ->  Parallel Seq Scan on orders_radb f0_2  (cost=0.00..7891.25 rows=62500 width=234) (actual time=0.015..31.189 rows=50000 loops=3)
                                                           Filter: ((tid IS NOT NULL) AND (o_orderkey IS NOT NULL) AND (o_custkey IS NOT NULL) AND (o_orderstatus IS NOT NULL) AND (o_totalprice IS NOT NULL) AND (o_orderdate IS NOT NULL) AND (o_orderpriority IS NOT NULL) AND (o_clerk IS NOT NULL) AND (o_shippriority IS NOT NULL) AND (o_comment IS NOT NULL) AND (bst_r > 0))
                                                     ->  Parallel Hash  (cost=1201.37..1201.37 rows=485 width=523) (actual time=4.490..4.490 rows=201 loops=3)
                                                           Buckets: 1024  Batches: 1  Memory Usage: 392kB
                                                           ->  Hash Join  (cost=16.14..1201.37 rows=485 width=523) (actual time=0.088..4.174 rows=201 loops=3)
                                                                 Hash Cond: (f0.c_nationkey = f0_1.n_nationkey)
                                                                 ->  Parallel Seq Scan on customer_radb f0  (cost=0.00..1147.29 rows=8824 width=343) (actual time=0.012..3.535 rows=5000 loops=3)
                                                                       Filter: ((tid IS NOT NULL) AND (c_custkey IS NOT NULL) AND (c_name IS NOT NULL) AND (c_address IS NOT NULL) AND (c_nationkey IS NOT NULL) AND (c_phone IS NOT NULL) AND (c_acctbal IS NOT NULL) AND (c_mktsegment IS NOT NULL) AND (c_comment IS NOT NULL) AND (bst_r > 0))
                                                                 ->  Hash  (cost=16.00..16.00 rows=11 width=188) (actual time=0.039..0.039 rows=1 loops=3)
                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                       ->  Seq Scan on nation_radb f0_1  (cost=0.00..16.00 rows=11 width=188) (actual time=0.032..0.035 rows=1 loops=3)
                                                                             Filter: ((tid IS NOT NULL) AND (n_nationkey IS NOT NULL) AND (n_name IS NOT NULL) AND (n_regionkey IS NOT NULL) AND (n_comment IS NOT NULL) AND (lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text) AND (CASE WHEN (n_name = 'CHINA'::text) THEN 1 ELSE 0 END > 0))
                                                                             Rows Removed by Filter: 24
                                   ->  Hash  (cost=94.94..94.94 rows=55 width=132) (actual time=0.937..0.938 rows=49 loops=3)
                                         Buckets: 1024  Batches: 1  Memory Usage: 13kB
                                         ->  Hash Join  (cost=16.14..94.94 rows=55 width=132) (actual time=0.162..0.915 rows=49 loops=3)
                                               Hash Cond: (f0_4.s_nationkey = f0_3.n_nationkey)
                                               ->  Seq Scan on supplier_radb f0_4  (cost=0.00..74.50 rows=1000 width=32) (actual time=0.037..0.685 rows=1000 loops=3)
                                                     Filter: ((s_suppkey IS NOT NULL) AND (s_nationkey IS NOT NULL) AND (bst_r > 0))
                                               ->  Hash  (cost=16.00..16.00 rows=11 width=108) (actual time=0.099..0.099 rows=1 loops=3)
                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                     ->  Seq Scan on nation_radb f0_3  (cost=0.00..16.00 rows=11 width=108) (actual time=0.069..0.083 rows=1 loops=3)
                                                           Filter: ((n_nationkey IS NOT NULL) AND (n_name IS NOT NULL) AND (lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text) AND (CASE WHEN (n_name = 'GERMANY'::text) THEN 1 ELSE 0 END > 0))
                                                           Rows Removed by Filter: 24
     ->  Nested Loop  (cost=70519.94..515972860605.85 rows=1762724670510 width=216) (actual time=320.852..321.418 rows=24 loops=1)
           Join Filter: (((min(f0_12.lb_o_orderkey)) <= (max(f0_8.ub_o_orderkey))) AND ((max(f0_12.ub_o_orderkey)) >= (min(f0_8.lb_o_orderkey))))
           ->  Nested Loop  (cost=55757.36..25704531.16 rows=162811397 width=264) (actual time=234.427..234.916 rows=12 loops=1)
                 Join Filter: (((min(f0_9.lb_l_orderkey)) <= (max(f0_8.ub_o_orderkey))) AND ((max(f0_9.ub_l_orderkey)) >= (min(f0_8.lb_o_orderkey))))
                 ->  HashAggregate  (cost=11985.00..14578.06 rows=148175 width=36) (actual time=78.468..78.928 rows=2 loops=1)
                       Group Key: CASE WHEN (f0_8.o_orderkey >= 300000) THEN 300000 WHEN ((f0_8.o_orderkey < 300000) AND (f0_8.o_orderkey >= 1)) THEN 1 ELSE 1 END
                       ->  Seq Scan on orders_radb f0_8  (cost=0.00..9735.00 rows=150000 width=16) (actual time=0.012..53.532 rows=150000 loops=1)
                 ->  Materialize  (cost=43772.36..45701.01 rows=9889 width=228) (actual time=77.977..77.988 rows=6 loops=2)
                       ->  Nested Loop  (cost=43772.36..45651.56 rows=9889 width=228) (actual time=155.950..155.968 rows=6 loops=1)
                             Join Filter: ((f1.lb_s_suppkey <= (max(f0_9.ub_l_suppkey))) AND (f1.ub_s_suppkey >= (min(f0_9.lb_l_suppkey))))
                             ->  Finalize GroupAggregate  (cost=43654.79..43950.64 rows=1000 width=48) (actual time=155.309..155.314 rows=2 loops=1)
                                   Group Key: (CASE WHEN (f0_9.l_suppkey >= 500) THEN 500 WHEN ((f0_9.l_suppkey < 500) AND (f0_9.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                   ->  Gather Merge  (cost=43654.79..43888.14 rows=2000 width=40) (actual time=155.300..155.333 rows=6 loops=1)
                                         Workers Planned: 2
                                         Workers Launched: 2
                                         ->  Sort  (cost=42654.77..42657.27 rows=1000 width=40) (actual time=152.227..152.228 rows=2 loops=3)
                                               Sort Key: (CASE WHEN (f0_9.l_suppkey >= 500) THEN 500 WHEN ((f0_9.l_suppkey < 500) AND (f0_9.l_suppkey >= 1)) THEN 1 ELSE 1 END)
                                               Sort Method: quicksort  Memory: 25kB
                                               Worker 0:  Sort Method: quicksort  Memory: 25kB
                                               Worker 1:  Sort Method: quicksort  Memory: 25kB
                                               ->  Partial HashAggregate  (cost=42587.44..42604.94 rows=1000 width=40) (actual time=152.197..152.201 rows=2 loops=3)
                                                     Group Key: CASE WHEN (f0_9.l_suppkey >= 500) THEN 500 WHEN ((f0_9.l_suppkey < 500) AND (f0_9.l_suppkey >= 1)) THEN 1 ELSE 1 END
                                                     ->  Parallel Seq Scan on lineitem_radb f0_9  (cost=0.00..37582.94 rows=250225 width=28) (actual time=0.042..111.079 rows=200191 loops=3)
                             ->  Materialize  (cost=117.57..133.65 rows=89 width=180) (actual time=0.319..0.323 rows=3 loops=2)
                                   ->  Nested Loop  (cost=117.57..133.20 rows=89 width=180) (actual time=0.634..0.641 rows=3 loops=1)
                                         Join Filter: (((min(f0_10.lb_n_nationkey)) <= f1.ub_s_nationkey) AND ((max(f0_10.ub_n_nationkey)) >= f1.lb_s_nationkey))
                                         Rows Removed by Join Filter: 1
                                         ->  HashAggregate  (cost=15.57..16.13 rows=32 width=132) (actual time=0.062..0.063 rows=2 loops=1)
                                               Group Key: CASE WHEN (f0_10.n_nationkey >= 12) THEN 12 WHEN ((f0_10.n_nationkey < 12) AND (f0_10.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                               ->  Seq Scan on nation_radb f0_10  (cost=0.00..14.75 rows=33 width=108) (actual time=0.023..0.054 rows=2 loops=1)
                                                     Filter: ((lb_n_name <= 'GERMANY'::text) AND (ub_n_name >= 'GERMANY'::text))
                                                     Rows Removed by Filter: 23
                                         ->  Materialize  (cost=102.00..102.81 rows=25 width=48) (actual time=0.284..0.286 rows=2 loops=2)
                                               ->  Subquery Scan on f1  (cost=102.00..102.69 rows=25 width=48) (actual time=0.557..0.559 rows=2 loops=1)
                                                     ->  HashAggregate  (cost=102.00..102.44 rows=25 width=48) (actual time=0.556..0.558 rows=2 loops=1)
                                                           Group Key: CASE WHEN (f0_11.s_nationkey >= 12) THEN 12 WHEN ((f0_11.s_nationkey < 12) AND (f0_11.s_nationkey >= 0)) THEN 0 ELSE 0 END
                                                           ->  Seq Scan on supplier_radb f0_11  (cost=0.00..79.50 rows=1000 width=28) (actual time=0.006..0.348 rows=1000 loops=1)
           ->  Materialize  (cost=14762.57..30903.85 rows=97564 width=228) (actual time=7.201..7.206 rows=2 loops=12)
                 ->  Nested Loop  (cost=14762.57..30416.03 rows=97564 width=228) (actual time=86.409..86.459 rows=2 loops=1)
                       Join Filter: ((f0_7.lb_c_custkey <= (max(f0_12.ub_o_custkey))) AND (f0_7.ub_c_custkey >= (min(f0_12.lb_o_custkey))))
                       ->  HashAggregate  (cost=13110.00..13282.66 rows=9866 width=660) (actual time=78.121..78.166 rows=2 loops=1)
                             Group Key: CASE WHEN (f0_12.o_custkey >= 7500) THEN 7500 WHEN ((f0_12.o_custkey < 7500) AND (f0_12.o_custkey >= 1)) THEN 1 ELSE 1 END
                             ->  Seq Scan on orders_radb f0_12  (cost=0.00..9735.00 rows=150000 width=28) (actual time=0.008..48.418 rows=150000 loops=1)
                       ->  Materialize  (cost=1652.57..1668.65 rows=89 width=180) (actual time=4.142..4.144 rows=1 loops=2)
                             ->  Nested Loop  (cost=1652.57..1668.20 rows=89 width=180) (actual time=8.273..8.275 rows=1 loops=1)
                                   Join Filter: ((f0_7.lb_c_nationkey <= (max(f0_13.ub_n_nationkey))) AND (f0_7.ub_c_nationkey >= (min(f0_13.lb_n_nationkey))))
                                   Rows Removed by Join Filter: 1
                                   ->  HashAggregate  (cost=15.57..16.13 rows=32 width=252) (actual time=0.051..0.051 rows=1 loops=1)
                                         Group Key: CASE WHEN (f0_13.n_nationkey >= 12) THEN 12 WHEN ((f0_13.n_nationkey < 12) AND (f0_13.n_nationkey >= 0)) THEN 0 ELSE 0 END
                                         ->  Seq Scan on nation_radb f0_13  (cost=0.00..14.75 rows=33 width=108) (actual time=0.023..0.039 rows=2 loops=1)
                                               Filter: ((lb_n_name <= 'CHINA'::text) AND (ub_n_name >= 'CHINA'::text))
                                               Rows Removed by Filter: 23
                                   ->  Materialize  (cost=1637.00..1637.81 rows=25 width=48) (actual time=8.217..8.219 rows=2 loops=1)
                                         ->  Subquery Scan on f0_7  (cost=1637.00..1637.69 rows=25 width=48) (actual time=8.215..8.217 rows=2 loops=1)
                                               ->  HashAggregate  (cost=1637.00..1637.44 rows=25 width=564) (actual time=8.214..8.215 rows=2 loops=1)
                                                     Group Key: CASE WHEN (f0_14.c_nationkey >= 12) THEN 12 WHEN ((f0_14.c_nationkey < 12) AND (f0_14.c_nationkey >= 0)) THEN 0 ELSE 0 END
                                                     ->  Seq Scan on customer_radb f0_14  (cost=0.00..1299.50 rows=15000 width=28) (actual time=0.005..5.284 rows=15000 loops=1)
   Planning Time: 4.787 ms
   Execution Time: 544.286 ms
#+end_example
* Test cases
- one join
#+begin_src sql
urange (SELECT c_custkey, n_nationkey as o1 FROM customer_radb is RADB join (select * from nation_radb is RADB where n_name = 'CHINA') on c_nationkey = n_nationkey);
#+end_src
- one join and selections
  #+begin_src sql
urange (SELECT c_custkey, n_nationkey as o1 FROM customer_radb is RADB join (select * from nation_radb is RADB where n_name = 'CHINA') on c_nationkey = n_nationkey);
  #+end_src
- multiway join (PDBench Q3)
  #+begin_src sql
urange (SELECT n1, n2 from (SELECT n_name as n1, o_orderkey as o1 FROM (customer_radb is RADB join (select * from nation_radb is RADB where n_name = 'CHINA') on c_nationkey = n_nationkey) join orders_radb is RADB on c_custkey = o_custkey) join (select n_name as n2, o_orderkey as o2 from ((select n_name,n_nationkey from nation_radb is RADB where n_name = 'GERMANY') join (select s_suppkey,s_nationkey from supplier_radb is RADB) on n_nationkey = s_nationkey) join (select l_orderkey, l_suppkey from lineitem_radb is RADB) on s_suppkey = l_suppkey join (select o_orderkey from orders_radb is RADB) on l_orderkey = o_orderkey) on o1=o2);
  #+end_src
- aggregation (GB)
  #+begin_src sql
urange (SELECT c_nationkey, sum(1) AS x FROM customer_radb is RADB GROUP BY c_nationkey);
  #+end_src
- aggrgeation (no GB)
#+begin_src sql
urange (SELECT sum(c_custkey) AS x FROM customer_radb is RADB);
urange (SELECT min(c_custkey) AS x FROM customer_radb is RADB);
urange (SELECT count(1) AS x FROM customer_radb is RADB);
#+end_src
